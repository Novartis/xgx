<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andy Stein" />


<title>PK - Multiple Ascending Dose - Using Novartis dzz file</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  .visible-sm-block {padding-top: 120px;}
  .visible-md-block {padding-top: 60px;}
  .visible-lg-block {padding-top: 0px;}
  
</style>


<span class=visible-sm-block> </span>
<span class=visible-md-block> </span>
<span class=visible-lg-block> </span>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">xGx</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-home"></span>
     
  </a>
</li>
<li>
  <a href="GuidingPrinciples.html">Guiding Principles</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datasets.html">Dataset Specifications</a>
    </li>
    <li>
      <a href="PKPD_Datasets.html">Master PK/PD Datasets used in creating example plots</a>
    </li>
    <li>
      <a href="Data_Checking.html">Data Checking</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Dose-PK/Exposure
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Single_Ascending_Dose_PK.html">Single Ascending Dose - PK</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PK.html">Multiple Ascending Dose - PK</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PK_KeyPlots.html">Example using realistic data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Dose-PD/Efficacy/Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Multiple_Ascending_Dose_PD_continuous.html">Continuous</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_binary.html">Binary Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_ordinal.html">Ordinal Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_count.html">Count Data</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_time_to_event.html">Time to Event</a>
    </li>
    <li>
      <a href="Oncology_Efficacy_Plots.html">Oncology Efficacy Endpoints (RECIST)</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_real_example.html">PD/Efficacy Example using realistic data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    PK-PD/Efficacy/Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_continuous.html">Continuous</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_binary.html">Binary Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_ordinal.html">Ordinal Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_count.html">Count Data</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_time_to_event.html">Time to Event</a>
    </li>
    <li>
      <a href="Adverse_Events.html">Adverse Events</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Resources/PKPD_Exploratory_Graphics_(xGx)_Cheat_Sheet.pdf">PKPD Cheat Sheet</a>
    </li>
    <li>
      <a href="Resources/Graphics_Principles_Cheat_Sheet_v1.1.pdf">Graphics Principles Cheat Sheet</a>
    </li>
    <li>
      <a href="Resources/FundamentalPK_AndyStein_Hackathon_2019.pptx">Fundamental PK Principles Introduction</a>
    </li>
    <li>
      <a href="Resources/FundamentalPD_AndyStein_Hackathon_2019.pptx">Fundamental PD Principles Introduction</a>
    </li>
    <li>
      <a href="Resources/Presentation_Checklist_v2.03.pdf">Presentation Checklist</a>
    </li>
    <li>
      <a href="Resources/Uncertainty_Assessment_Pedigree_Table.pdf">Uncertainty Assessment - Pedigree Table</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<style type="text/css">
  .visible-sm-block {padding-top: 120px;}
  .visible-md-block {padding-top: 60px;}
  .visible-lg-block {padding-top: 0px;}
  .navbar-image {width: 150px;}
  .warning { 
      font-size: 200% ; 
      color: red; 
      padding-top: 200px;
    }
    }
  
  @media (min-width: 992px) and (max-width: 1200px){
    .navbar-image {width: 19%;}
    
    .section h1 {
  padding-top: 110px;
  margin-top: -110px;
  }

  .section h2 {
  padding-top: 110px;
  margin-top: -110px;
  }
  
    .section h3 {
  padding-top: 110px;
  margin-top: -110px;
  }
  }
  
  
  @media (min-width: 768px) and (max-width: 991px){

    .navbar-image {width: 19%;}
    
    .section h1 {
  padding-top: 160px;
  margin-top: -160px;
  }

  .section h2 {
  padding-top: 160px;
  margin-top: -160px;
  }
  
    .section h3 {
  padding-top: 160px;
  margin-top: -160px;
  }
  }
  
@media (max-width: 768px){
  .navbar-image {width: 19%;}

}
  

</style>


<!--[if IE]>
<p/>
<p/>
<p class="warning"> Dear Internet Explorer user: Please ensure compatibility view settings are turned OFF in order to view this website propertly. For best results, use Chrome. <br/>
<p/>
 <![endif]--> 


<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">PK - Multiple Ascending Dose - Using Novartis dzz file</h1>
<h4 class="author">Andy Stein</h4>

</div>


<div id="overview" class="section level3">
<h3>Overview</h3>
<!--START_EXPLANATION-->
<p>This document contains PK exploratory graphs and also the R code that generates these graphs, starting from the <code>dzz</code> and <code>PPtmp</code> files that are stored at the links below. For detailed thougths on how to interpret these graphs, please consult the other xGx PK pages for <a href="Single_Ascending_Dose_PK.html">Single Ascending Dose</a> and <a href="Multiple_Ascending_Dose_PK.html">Multiple Ascending Dose</a></p>
<ul>
<li><a href="Data/dzz_PKConc.csv">dzz blinded dataset of drug concentrations</a></li>
<li><a href="Data/PPtmp_NCA.csv">PPtmp blinded dataset of NCA parameters</a></li>
</ul>
<p>Data specifications can be accessed on <a href="Datasets.html">Datasets</a> and Rmarkdown template to generate this page can be found on <a href="Rmarkdown/Multiple_Ascending_Dose_PK_KeyPlots.Rmd">Rmarkdown-Template</a>. <!--END_EXPLANATION--> ### Setup</p>
<pre class="r"><code>#add key packages
  library(ggplot2)
  library(tidyr)
  library(dplyr)
  library(stringr)
  library(xgxr)#, lib.loc = &quot;../Rlib&quot;)
  
  
#flag for labeling figures as draft
  status = &quot;DRAFT&quot;

# ggplot settings
  xgx_theme_set()
  
# directories for saving individual graphs
dirs = list(
  parent_dir= &quot;Parent_Directory&quot;,
  rscript_dir  = &quot;./&quot;,
  rscript_name = &quot;Example.R&quot;,
  results_dir  = &quot;./&quot;,
  filename_prefix   = &quot;&quot;,
  filename     = &quot;Example.png&quot;)</code></pre>
<div id="load-in-data-from-dzz-concentrations-and-format-for-plotting" class="section level4">
<h4>Load in data from dzz (concentrations) and format for plotting</h4>
<pre class="r"><code>#load data located here:
data_in = read.csv(&quot;../Data/dzz_PKConc.csv&quot;,stringsAsFactors = FALSE)

#create columns with dosing regimen information, based on ARM
LOQassay = 1
drug_name = &quot;ABC123&quot;

#create simplified column names for plotting
data = data_in %&gt;%
  mutate(TRTACT          = str_replace(ARM,&quot;Phase Ib? &quot;,&quot;&quot;),
        TRTACT           = str_replace(TRTACT,paste0(drug_name,&quot; &quot;),&quot;&quot;),
        TRTACT           = str_extract(TRTACT ,&quot;^\\d* *mg Q\\dW&quot;),
        DOSE             = as.numeric(str_extract(TRTACT,&quot;\\d*&quot;)),
        REGIMEN          = str_extract(TRTACT,&quot;Q\\dW&quot;)) %&gt;%
  arrange(DOSE, desc(REGIMEN), lubridate::ymd_hms(PCDTC)) %&gt;%
  mutate(TRTACT_high2low = factor(TRTACT,levels = rev(unique(TRTACT))),
         TRTACT_low2high = factor(TRTACT,levels =     unique(TRTACT)),
         DOSE_mg         = paste(DOSE,&quot;mg&quot;),
         DOSE_high2low   = factor(DOSE_mg, levels = rev(unique(DOSE_mg))),
         DOSE_low2high   = factor(DOSE_mg, levels =     unique(DOSE_mg)),
         ID              = SUBJID,
         CYCLE           = as.numeric(substr(VISIT,7,8))) %&gt;%
  group_by(ID) %&gt;%
  mutate(TIME            = as.numeric((lubridate::ymd_hms(PCDTC) - 
                                       lubridate::ymd_hms(first(PCDTC)))/3600),
         TIMEUNIT        = &quot;hours&quot;,
         DAY_OF_CYCLE    = TMTPT,
         NOMTIME         = (CYCLE-1)*28*24+DAY_OF_CYCLE,
         LIDV            = as.numeric(RESN),
         CENS            = LIDV &lt; LOQassay,
         LIDV            = ifelse(CENS, LOQassay, LIDV),
         LIDVNORM        = RESN/DOSE,
         LIDV_UNIT       = &quot;ng/ml&quot;) %&gt;%
  select(-TRTACT) %&gt;%
  ungroup() %&gt;%
  filter(NOMTIME &gt; 0, TIME &gt; 0, !is.na(TIME), !is.na(LIDV))</code></pre>
</div>
<div id="load-in-data-from-pptmp-nca-and-format-for-plotting" class="section level4">
<h4>Load in data from PPtmp (NCA) and format for plotting</h4>
<pre class="r"><code>nca = read.csv(&quot;../Data/PPtmp_NCA.csv&quot;,stringsAsFactors = FALSE)

#create columns with dosing regimen information, based on ARM
nca = nca %&gt;%
  mutate(ID              = SUBJID,
         TRTACT          = str_replace(ARM,&quot;Phase Ib? &quot;,&quot;&quot;),
         TRTACT          = str_replace(TRTACT,paste0(drug_name,&quot; &quot;),&quot;&quot;),
         TRTACT          = str_extract(TRTACT,&quot;^\\d* *mg Q\\dW&quot;),
         DOSE            = as.numeric(str_extract(TRTACT,&quot;\\d*&quot;)),
         REGIMEN         = str_extract(TRTACT,&quot;Q\\dW&quot;),
         PPORRESNnorm    = PPORRESN/DOSE) %&gt;%
  arrange(DOSE,desc(REGIMEN)) %&gt;%
  mutate(TRTACT_high2low = factor(TRTACT,levels=rev(unique(TRTACT))),
         TRTACT_low2high = factor(TRTACT,levels=unique(TRTACT))) </code></pre>
</div>
</div>
<div id="specify-units" class="section level2">
<h2>Specify units</h2>
<pre class="r"><code>#units and labels
  time_units_dataset = &quot;hours&quot;
  time_units_plot    = &quot;day&quot;
  trtact_label       = &quot;Dose&quot;
  dose_label         = &quot;Dose (mg)&quot;
  conc_label         = &quot;Concentration (ng/ml)&quot;  
  concnorm_label     = &quot;Normalized Concentration (ng/ml)/mg&quot;
  conc_units         = &quot;ng/ml&quot;
  AUC_units          = &quot;h.ng/ml&quot;</code></pre>
</div>
<div id="provide-an-overview-of-the-data" class="section level2">
<h2>Provide an overview of the data</h2>
<!--START_EXPLANATION-->
<p>Summarize the data in a way that is easy to visualize the general trend of PK over time and between doses. Using summary statistics can be helpful, e.g. Mean +/- SE, or median, 5th &amp; 95th percentiles. Consider either coloring by dose or faceting by dose. Depending on the amount of data one graph may be better than the other.</p>
<p>When looking at summaries of PK over time, there are several things to observe. Note the number of doses and number of time points or sampling schedule. Observe the overall shape of the average profiles. What is the average Cmax per dose? Tmax? Does the elimination phase appear to be parallel across the different doses? Is there separation between the profiles for different doses? Can you make a visual estimate of the number of compartments that would be needed in a PK model? <!--END_EXPLANATION--> ### Concentration over time, faceted by regimen, colored by dose</p>
<pre class="r"><code>gg &lt;- ggplot(data = data, aes(x = NOMTIME, y = LIDV, color = DOSE_high2low, group=DOSE_high2low))
gg &lt;- gg + facet_grid(~REGIMEN)
gg &lt;- gg + xgx_scale_y_log10() 
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + labs(y=conc_label, color = trtact_label)
gg &lt;- gg + xgx_annotate_status(status)
gg &lt;- gg + xgx_annotate_filenames(dirs)
gg1&lt;- gg
gg &lt;- gg + xgx_stat_ci(conf_level = 0.95, geom = list(&quot;point&quot;,&quot;line&quot;,&quot;errorbar&quot;), alpha = 0.5, position = position_dodge(width = 24*5))
#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width,height,dirs,&quot;filename_main&quot;,status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PK_KeyPlots_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<div id="concentration-over-time-faceted-by-regimen-and-cycle-number-colored-by-dose" class="section level3">
<h3>Concentration over time, faceted by regimen and cycle number, colored by dose</h3>
<pre class="r"><code>gg &lt;- gg1
gg &lt;- gg + xgx_stat_ci(conf_level = 0.95, geom = list(&quot;point&quot;,&quot;line&quot;,&quot;errorbar&quot;), alpha = 0.5, position = position_dodge(width = 24))
gg &lt;- gg %+% filter(data, CYCLE %in% c(1,3))
gg &lt;- gg + aes(x = DAY_OF_CYCLE, y = LIDV)
gg &lt;- gg + labs(x = &quot;Day&quot;)
gg &lt;- gg + facet_grid(CYCLE~REGIMEN, labeller = label_both, switch = &quot;y&quot;)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PK_KeyPlots_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
</div>
</div>
<div id="assess-the-dose-linearity-of-exposure" class="section level2">
<h2>Assess the dose linearity of exposure</h2>
<div id="dose-normalized-concentration" class="section level3">
<h3>Dose normalized concentration</h3>
<pre class="r"><code>gg &lt;- ggplot(data = data, aes(x = NOMTIME, y = LIDVNORM, color = DOSE_high2low, group=DOSE_high2low))
gg &lt;- gg + xgx_stat_ci(conf_level = 0.95, geom = list(&quot;point&quot;,&quot;line&quot;,&quot;errorbar&quot;), alpha = 0.5, position = position_dodge(width = 24*5))
gg &lt;- gg + facet_grid(~REGIMEN)
gg &lt;- gg + xgx_scale_y_log10() 
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + labs(y=conc_label, color = trtact_label)
gg &lt;- gg + xgx_annotate_status(status)
gg &lt;- gg + xgx_annotate_filenames(dirs)
#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width,height,dirs,&quot;filename_main&quot;,status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PK_KeyPlots_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
<div id="noncompartmental-analysis" class="section level3">
<h3>Noncompartmental Analysis</h3>
<!--START_EXPLANATION-->
<p>Observe the dose normalized AUC over different doses. Does the relationship appear to be constant across doses or do some doses stand out from the rest? Can you think of reasons why some would stand out? For example, the lowest dose may have dose normalized AUC much higher than the rest, could this be due to CENS observations? If the highest doses have dose normalized AUC much higher than the others, could this be due to nonlinear clearance, with clearance saturating at higher doses? If the highest doses have dose normalized AUC much lower than the others, could there be saturation of bioavailability, reaching the maximum absorbable dose? <!--END_EXPLANATION--></p>
<pre class="r"><code>nca.filter = nca %&gt;% 
  filter(WNLPARM %in% c(&quot;AUCINF_obs&quot;,&quot;AUClast&quot;,&quot;AUCtau&quot;,&quot;Cmax&quot;))
gg &lt;- ggplot(nca.filter,aes(x=DOSE,y=PPORRESNnorm,group=DOSE))
gg &lt;- gg + geom_boxplot(outlier.shape=NA)
gg &lt;- gg + geom_smooth(aes(group=NULL),show.legend = FALSE,se=FALSE)
gg &lt;- gg + geom_jitter(width=0,alpha=.3)
gg &lt;- gg + facet_grid(WNLPARM~REGIMEN,scales=&quot;free_y&quot;,switch=&quot;y&quot;)
gg &lt;- gg + xgx_scale_y_log10()
gg &lt;- gg + xgx_scale_x_log10(breaks=unique(data$DOSE))
gg &lt;- gg + labs(x=&quot;First Dose (mg)&quot;,
             y=&quot;Normalized value (ug/ml/mg or ug/ml*d/mg)&quot;)
gg &lt;- gg + xgx_annotate_status(status)
gg &lt;- gg + xgx_annotate_filenames(dirs)
#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width,height,dirs,&quot;filename_main&quot;,status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PK_KeyPlots_files/figure-html/unnamed-chunk-8-1.png" width="576" /></p>
</div>
</div>
<div id="explore-variability" class="section level2">
<h2>Explore variability</h2>
<!--START_EXPLANATION-->
<p>Use spaghetti plots to visualize the extent of variability between individuals. The wider the spread of the profiles, the higher the between subject variability. Distinguish different doses by color, or separate into different panels. If coloring by dose, do the individuals in the different dose groups overlap across doses? Dose there seem to be more variability at higher or lower concentrations? <!--END_EXPLANATION--> ### Spaghetti, grouped by dose</p>
<pre class="r"><code>gg &lt;- ggplot(data = data, aes(x=TIME, y=LIDV, group=ID))
gg &lt;- gg + geom_line(mapping=aes(group=ID), alpha = 0.5) 
gg &lt;- gg + geom_point(alpha = 0.5)
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + xgx_scale_y_log10() 
gg &lt;- gg + labs(y=conc_label, color = trtact_label)
gg &lt;- gg + theme(legend.position=&quot;none&quot;)   
gg &lt;- gg + facet_grid(REGIMEN~DOSE_low2high,switch=&quot;y&quot;)
gg &lt;- gg + xgx_annotate_status(status)
gg &lt;- gg + xgx_annotate_filenames(dirs)
#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width,height,dirs,&quot;filename_main&quot;,status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PK_KeyPlots_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
</div>
<div id="explore-irregularities-in-profiles" class="section level2">
<h2>Explore irregularities in profiles</h2>
<!--START_EXPLANATION-->
<p>Plot individual profiles in order to inspect them for any irregularities. Inspect the profiles for outlying data points that may skew results or bias conclusions. Looking at the shapes of the individual profiles now, do they support your observations made about the mean profile (e.g. number of compartments, typical Cmax, Tmax)? <!--END_EXPLANATION--> ### Individual profiles</p>
<pre class="r"><code>gg &lt;- ggplot(data = data, aes(x=TIME, y=LIDV, group=ID))
gg &lt;- gg + geom_line() 
gg &lt;- gg + geom_point()
gg &lt;- gg + facet_wrap(~TRTACT_low2high + ID)
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + xgx_scale_y_log10() 
gg &lt;- gg + labs(y=conc_label, color = trtact_label)
gg &lt;- gg + theme(legend.position=&quot;none&quot;)   
gg &lt;- gg + xgx_annotate_status(status)
gg &lt;- gg + xgx_annotate_filenames(dirs)
#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width,height,dirs,&quot;filename_main&quot;,status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PK_KeyPlots_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<div id="r-session-info" class="section level3">
<h3>R Session Info</h3>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Red Hat Enterprise Linux
## 
## Matrix products: default
## BLAS/LAPACK: /CHBS/apps/EB/software/imkl/2019.1.144-gompi-2019a/compilers_and_libraries_2019.1.144/linux/mkl/lib/intel64_lin/libmkl_gf_lp64.so
## 
## Random number generation:
##  RNG:     Mersenne-Twister 
##  Normal:  Inversion 
##  Sample:  Rounding 
##  
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] survminer_0.4.9 ggpubr_0.4.0    survival_3.2-11 knitr_1.33      broom_0.7.9     caTools_1.18.2  DT_0.18        
##  [8] forcats_0.5.1   stringr_1.4.0   purrr_0.3.4     readr_2.0.1     tibble_3.1.3    tidyverse_1.3.1 zoo_1.8-9      
## [15] xgxr_1.1.1      gridExtra_2.3   tidyr_1.1.3     dplyr_1.0.7     ggplot2_3.3.5  
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_2.0-2    ggsignif_0.6.2      rio_0.5.27          ellipsis_0.3.2      class_7.3-19       
##   [6] rsconnect_0.8.24    htmlTable_2.2.1     markdown_1.1        base64enc_0.1-3     fs_1.5.0           
##  [11] gld_2.6.2           rstudioapi_0.13     proxy_0.4-26        farver_2.1.0        Deriv_4.1.3        
##  [16] fansi_0.5.0         mvtnorm_1.1-2       lubridate_1.7.10    xml2_1.3.2          codetools_0.2-18   
##  [21] splines_4.1.0       rootSolve_1.8.2.2   Formula_1.2-4       jsonlite_1.7.2      km.ci_0.5-2        
##  [26] binom_1.1-1         cluster_2.1.2       dbplyr_2.1.1        png_0.1-7           compiler_4.1.0     
##  [31] httr_1.4.2          backports_1.2.1     assertthat_0.2.1    Matrix_1.3-3        cli_3.0.1          
##  [36] prettyunits_1.1.1   htmltools_0.5.1.1   tools_4.1.0         gtable_0.3.0        glue_1.4.2         
##  [41] lmom_2.8            Rcpp_1.0.7          carData_3.0-4       cellranger_1.1.0    jquerylib_0.1.4    
##  [46] vctrs_0.3.8         nlme_3.1-152        crosstalk_1.1.1     xfun_0.25           openxlsx_4.2.4     
##  [51] rvest_1.0.1         lifecycle_1.0.0     rstatix_0.7.0       MASS_7.3-54         scales_1.1.1       
##  [56] hms_1.1.0           expm_0.999-6        RColorBrewer_1.1-2  curl_4.3.2          yaml_2.2.1         
##  [61] Exact_2.1           KMsurv_0.1-5        pander_0.6.4        sass_0.4.0          rpart_4.1-15       
##  [66] reshape_0.8.8       latticeExtra_0.6-29 stringi_1.7.3       highr_0.9           e1071_1.7-8        
##  [71] checkmate_2.0.0     zip_2.2.0           boot_1.3-28         rlang_0.4.11        pkgconfig_2.0.3    
##  [76] bitops_1.0-7        evaluate_0.14       lattice_0.20-44     htmlwidgets_1.5.3   labeling_0.4.2     
##  [81] tidyselect_1.1.1    GGally_2.1.2        plyr_1.8.6          magrittr_2.0.1      R6_2.5.1           
##  [86] DescTools_0.99.42   generics_0.1.0      Hmisc_4.5-0         DBI_1.1.1           pillar_1.6.2       
##  [91] haven_2.4.3         foreign_0.8-81      withr_2.4.2         mgcv_1.8-35         abind_1.4-5        
##  [96] RCurl_1.98-1.4      nnet_7.3-16         car_3.0-11          modelr_0.1.8        crayon_1.4.1       
## [101] survMisc_0.5.5      utf8_1.2.2          tzdb_0.1.2          rmarkdown_2.11      jpeg_0.1-9         
## [106] progress_1.2.2      grid_4.1.0          readxl_1.3.1        minpack.lm_1.2-1    data.table_1.14.0  
## [111] reprex_2.0.1        digest_0.6.27       xtable_1.8-4        munsell_0.5.0       bslib_0.2.5.1</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
