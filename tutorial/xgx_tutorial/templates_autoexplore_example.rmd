## Templates - AutoExplore Example

We have seen previously how to apply the previously constructed 
xGx Rmd templates to our own data.

In this example, we will learn how to automatically construct one of the 
R-markdown templates for our data using the `xgx_autoexplore()` function.  
As we will see, the `xgx_autoexplore()` function makes process of analyzing 
our data take far fewer manual steps and is much more simple.


### Defining Parameters {data-progressive=FALSE}

We first define the parameters according to our desired analysis.
In order to reproduce the output from Section 
["Example 2 - Altering an xGx Template to New Data (Multiple Dose Continuous PKPD)"](## Example 2 - Altering an xGx Template to New Data (Multiple Dose Continuous PKPD)), 
we will choose our parameters to match this analysis template:

```{r }
# Include the new xgx_autoexplore function in the environment
devtools::source_url("https://raw.githubusercontent.com/Novartis/xgxr/chase/R/xgx_auto_explore.R", echo=FALSE)

author_name = "Your Name Here"

# Do you want text explaining the figures?
show_explanation = FALSE

# Your path to the data goes here
data_path <- "https://raw.githubusercontent.com/Novartis/xgxr/master/data_create/raw/nonlinear_pkpd.csv"

# Change your column names (left) to the column names that
#   have been standardized in the template (left)
mapping <- list(
  "TIME" = "TIM2",
  "NOMTIME" = "NT",
  "EVID" = 0,
  "CENS" = 0,
  "DOSE" = "MGKG",
  "TRTACT" = "TRT",
  "LIDV_NORM" = "LIDV/MGKG",
  "LIDV_UNIT" = "UNIT",
  "PROFDAY" = 1,
  "SEX" = 0,
  "WEIGHTB" = 0)

# SAD PK Parameters specific to your dataset
pk_cmt = 5 # Pk Concentration
pd_cmt = 4 # PD Continuous
pd_data_type = "continuous"
dose_cmt = 1
steady_state_day = c(0, 6)
time_between_doses = 24
multiple_dosing = TRUE
```

Notice that we have defined the `pk_cmt` and `pd_cmt` here, as well as the 
`multiple_dosing` parameter as `TRUE`.  This will tell the function to use 
the "Multiple Ascending Dose PKPD" template type.  
In order to choose the "Continuous" template for MAD PKPD, we also 
define `pd_data_type` as `"continuous"`.

Similar to how we altered the columns that are specific to our dataset, we have 
created a `mapping` from the columns of our dataset to the 
standardized xGx template columns.

### Output of `xgx_autoexplore()`

We may then provide these parameters to the `xgx_autoexplore()` function, after which
a folder will be created in the current working directory - "xgx_autoexplore_output".

```{r}
xgx_auto_explore(data_path = data_path,
                 mapping = mapping,
                 author_name = author_name,
                 pk_cmt = pk_cmt,
                 pd_cmt = pd_cmt,
                 dose_cmt = dose_cmt,
                 steady_state_day = steady_state_day,
                 time_between_doses = time_between_doses,
                 multiple_dosing = multiple_dosing,
                 pd_data_type = pd_data_type,
                 show_explanation = show_explanation)

# Check that the correct Rmd template is retrieved
knitr::include_url("https://opensource.nibr.com/xgx/Multiple_Ascending_Dose_PKPD_continuous.html",
  #"xgx_autoexplore_output/nonlinear_pkpd/Multiple_Ascending_Dose_PKPD_continuous/Multiple_Ascending_Dose_PKPD_continuous.html",
                   height = "600px")

# knitr::include_graphics(".pdf")
# htmltools::includeHTML
```

The main xgx_autoexplore directory ("xgx_autoexplore_output") will have a hierarchical structure, with 
each new dataset having it's own directory with the main xgx_autoexplore directory.
Furthermore, within each dataset directory, each template applied to this dataset 
will get it's own directory as well.