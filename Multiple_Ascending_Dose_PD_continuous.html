<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Alison Margolskee, Camille Vong" />


<title>PD, Dose-Response - Continuous Endpoint</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  .visible-sm-block {padding-top: 120px;}
  .visible-md-block {padding-top: 60px;}
  .visible-lg-block {padding-top: 0px;}
  
</style>


<span class=visible-sm-block> </span>
<span class=visible-md-block> </span>
<span class=visible-lg-block> </span>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">xGx</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-home"></span>
     
  </a>
</li>
<li>
  <a href="GuidingPrinciples.html">Guiding Principles</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datasets.html">Dataset Specifications</a>
    </li>
    <li>
      <a href="PKPD_Datasets.html">Master PK/PD Datasets used in creating example plots</a>
    </li>
    <li>
      <a href="Data_Checking.html">Data Checking</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dose-PK/Exposure
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Single_Ascending_Dose_PK.html">Single Ascending Dose - PK</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PK.html">Multiple Ascending Dose - PK</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PK_KeyPlots.html">Example using realistic data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dose-PD/Efficacy/Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Multiple_Ascending_Dose_PD_continuous.html">Continuous</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_binary.html">Binary Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_ordinal.html">Ordinal Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_count.html">Count Data</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_time_to_event.html">Time to Event</a>
    </li>
    <li>
      <a href="Oncology_Efficacy_Plots.html">Oncology Efficacy Endpoints (RECIST)</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_real_example.html">PD/Efficacy Example using realistic data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    PK-PD/Efficacy/Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_continuous.html">Continuous</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_binary.html">Binary Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_ordinal.html">Ordinal Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_count.html">Count Data</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_time_to_event.html">Time to Event</a>
    </li>
    <li>
      <a href="Adverse_Events.html">Adverse Events</a>
    </li>
  </ul>
</li>
<li>
  <a href="Resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<style type="text/css">
  .visible-sm-block {padding-top: 120px;}
  .visible-md-block {padding-top: 60px;}
  .visible-lg-block {padding-top: 0px;}
  .navbar-image {width: 150px;}
  .warning { 
      font-size: 200% ; 
      color: red; 
      padding-top: 200px;
    }
    }
  
  @media (min-width: 992px) and (max-width: 1200px){
    .navbar-image {width: 19%;}
    
    .section h1 {
  padding-top: 110px;
  margin-top: -110px;
  }

  .section h2 {
  padding-top: 110px;
  margin-top: -110px;
  }
  
    .section h3 {
  padding-top: 110px;
  margin-top: -110px;
  }
  }
  
  
  @media (min-width: 768px) and (max-width: 991px){

    .navbar-image {width: 19%;}
    
    .section h1 {
  padding-top: 160px;
  margin-top: -160px;
  }

  .section h2 {
  padding-top: 160px;
  margin-top: -160px;
  }
  
    .section h3 {
  padding-top: 160px;
  margin-top: -160px;
  }
  }
  
@media (max-width: 768px){
  .navbar-image {width: 19%;}

}
  

</style>


<!--[if IE]>
<p/>
<p/>
<p class="warning"> Dear Internet Explorer user: Please ensure compatibility view settings are turned OFF in order to view this website propertly. For best results, use Chrome. <br/>
<p/>
 <![endif]--> 


<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">PD, Dose-Response - Continuous
Endpoint</h1>
<h4 class="author">Alison Margolskee, Camille Vong</h4>

</div>


<div id="overview" class="section level2">
<h2>Overview</h2>
<!--START_EXPLANATION-->
<p>This document contains exploratory plots for multiple ascending
continuous PD data as well as the R code that generates these graphs.
The plots presented here are based on simulated data (<a
href="PKPD_Datasets.html">see: PKPD Datasets</a>). Data specifications
can be accessed on <a href="Datasets.html">Datasets</a> and Rmarkdown
template to generate this page can be found on <a
href="Rmarkdown/Multiple_Ascending_Dose_PD_continuous.Rmd">Rmarkdown-Template</a>.
You may also download the Multiple Ascending Dose PK/PD dataset for your
reference (<a href="Data/Multiple_Ascending_Dose_Dataset2.csv">download
dataset</a>). <!--END_EXPLANATION--></p>
</div>
<div id="setup" class="section level2">
<h2>Setup</h2>
<pre class="r"><code>library(ggplot2)
library(dplyr)
library(tidyr)
library(gridExtra)
library(xgxr)

#flag for labeling figures as draft
status = &quot;DRAFT&quot;

## ggplot settings
xgx_theme_set()

#directories for saving individual graphs
dirs = list(
  parent_dir = tempdir(), 
  rscript_dir  = &quot;./&quot;, 
  rscript_name = &quot;Example.R&quot;, 
  results_dir  = &quot;./&quot;, 
  filename_prefix   = &quot;&quot;, 
  filename     = &quot;Example.png&quot;)</code></pre>
</div>
<div id="load-dataset" class="section level2">
<h2>Load Dataset</h2>
<pre class="r"><code>#load dataset
pkpd_data &lt;- read.csv(&quot;../Data/Multiple_Ascending_Dose_Dataset2.csv&quot;)

DOSE_CMT = 1
PD_CMT = 3
SS_PROFDAY = 6 # steady state prof day
PD_PROFDAYS = c(0, 2, 4, 6)

#ensure dataset has all the necessary columns
pkpd_data = pkpd_data %&gt;%
    mutate(ID      = ID,     #ID   column
           TIME    = TIME,   #TIME column name 
           NOMTIME = NOMTIME, #NOMINAL TIME column name
           PROFDAY = case_when(
             NOMTIME &lt; (SS_PROFDAY - 1)*24 ~ 1 + floor(NOMTIME / 24), 
             NOMTIME &gt;= (SS_PROFDAY - 1)*24 ~ SS_PROFDAY
           ), #PROFILE DAY day associated with profile, e.g. day of dose administration
           LIDV    = LIDV,   #DEPENDENT VARIABLE column name
           CENS    = CENS,   #CENSORING column name
           CMT     = CMT,    #COMPARTMENT column
           DOSE    = DOSE,   #DOSE column here (numeric value)
           TRTACT  = TRTACT, #DOSE REGIMEN column here (character, with units), 
           LIDV_UNIT = EVENTU, 
           DAY_label = ifelse(PROFDAY &gt; 0, paste(&quot;Day&quot;, PROFDAY), &quot;Baseline&quot;)
    )
#create a factor for the treatment variable for plotting
pkpd_data = pkpd_data %&gt;%
  arrange(DOSE) %&gt;%
  mutate(TRTACT_low2high = factor(TRTACT, levels = unique(TRTACT)), 
         TRTACT_high2low = factor(TRTACT, levels = rev(unique(TRTACT))))

#create pd dataset
pd_data &lt;- pkpd_data %&gt;%
  filter(CMT == PD_CMT)

#units and labels
  time_units_dataset = &quot;hours&quot;
  time_units_plot    = &quot;days&quot;
  trtact_label       = &quot;Dose&quot;
  dose_units         = unique((pkpd_data %&gt;% filter(CMT == DOSE_CMT))$LIDV_UNIT) %&gt;% as.character()
  dose_label         = paste0(&quot;Dose (&quot;, dose_units, &quot;)&quot;)
  pd_units           = unique(pd_data$LIDV_UNIT) %&gt;% as.character()
  pd_label           = paste0(&quot;Continuous PD Marker (&quot;, pd_units, &quot;)&quot;)  </code></pre>
</div>
<div id="provide-an-overview-of-the-data" class="section level2">
<h2>Provide an overview of the data</h2>
<!--START_EXPLANATION-->
<p>Summarize the data in a way that is easy to visualize the general
trend of PD over time and between doses. Using summary statistics can be
helpful, e.g. Mean +/- SE, or median, 5th &amp; 95th percentiles.
Consider either coloring by dose or faceting by dose. Depending on the
amount of data one graph may be better than the other.</p>
<p>When looking at summaries of continuous PD over time, there are
several things to observe. Note the number of doses and number of time
points or sampling schedule. Observe the overall shape of the average
profiles. How does the profile change over time? Does the effect appear
to increase and decrease quickly on a short time scale, or does is occur
over a longer time scale? Is there clear separation between the profiles
for different doses? Does the effect appear to increase with increasing
dose? Do you detect a saturation of the effect?
<!--END_EXPLANATION--></p>
<div
id="pd-marker-over-time-colored-by-dose-mean-95-ci-percentiles-by-nominal-time"
class="section level3">
<h3>PD marker over time, colored by Dose, mean (95% CI) percentiles by
nominal time</h3>
<pre class="r"><code>#PD data
gg &lt;- ggplot(data = pd_data, 
               aes(x = NOMTIME, y = LIDV, color = TRTACT_high2low, fill = TRTACT_high2low)) 
gg &lt;- gg + xgx_stat_ci(conf_level = .95, position = position_dodge(width = 12), alpha = 0.5)
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + labs(y = pd_label)
gg &lt;- gg + xgx_annotate_status(status)

#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
</div>
<div
id="pd-marker-over-time-faceted-by-dose-mean-95-ci-percentiles-by-nominal-time"
class="section level3">
<h3>PD marker over time, faceted by Dose, mean (95% CI) percentiles by
nominal time</h3>
<pre class="r"><code>gg &lt;- ggplot(data = pd_data, 
               aes(x = NOMTIME, y = LIDV)) 
gg &lt;- gg + xgx_stat_ci(conf_level = .95)
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + facet_grid(~TRTACT_low2high)
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + scale_y_continuous()
gg &lt;- gg + labs(y = pd_label)
gg &lt;- gg + xgx_annotate_status(status)

#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
</div>
</div>
<div id="explore-variability" class="section level2">
<h2>Explore variability</h2>
<!--START_EXPLANATION-->
<p>Use spaghetti plots to visualize the extent of variability between
individuals. The wider the spread of the profiles, the higher the
between subject variability. Distinguish different doses by color, or
separate into different panels. If coloring by dose, do the individuals
in the different dose groups overlap across doses? Dose there seem to be
more variability at higher or lower concentrations?
<!--END_EXPLANATION--></p>
<div
id="pd-marker-over-time-colored-by-dose-dots-lines-grouped-by-individuals"
class="section level3">
<h3>PD marker over time, colored by Dose, dots &amp; lines grouped by
individuals</h3>
<pre class="r"><code>gg &lt;- ggplot(data = pd_data, 
             aes(x = TIME, y = LIDV, group = ID, color = factor(TRTACT_high2low))) 
gg &lt;- gg + geom_line(alpha = 0.5)
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)    
gg &lt;- gg + labs(y = pd_label)
gg &lt;- gg + xgx_annotate_status(status)

#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
</div>
<div
id="pd-marker-over-time-faceted-by-dose-dots-lines-grouped-by-individuals"
class="section level3">
<h3>PD marker over time, faceted by Dose, dots &amp; lines grouped by
individuals</h3>
<pre class="r"><code>gg &lt;- ggplot(data = pd_data, 
             aes(x = TIME, y = LIDV, group = ID)) 
gg &lt;- gg + geom_line(alpha = 0.5)
gg &lt;- gg + geom_point(alpha = 0.5)
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)    
gg &lt;- gg + facet_grid(~TRTACT_low2high)
gg &lt;- gg + labs(y = pd_label)
gg &lt;- gg + xgx_annotate_status(status)
#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
</div>
</div>
<div id="explore-irregularities-in-profiles" class="section level2">
<h2>Explore Irregularities in Profiles</h2>
<!--START_EXPLANATION-->
<p>Plot individual profiles in order to inspect them for any
irregularities. Inspect the profiles for outlying data points that may
skew results or bias conclusions. <!--END_EXPLANATION--></p>
<div
id="pd-marker-over-time-faceted-by-individual-individual-line-plots-overlaid-on-gray-spaghetti-plots-for-that-dose-group"
class="section level3">
<h3>PD marker over time, faceted by individual, individual line plots
overlaid on gray spaghetti plots for that dose group</h3>
<!--START_EXPLANATION-->
<p>Plotting individual profiles on top of gray spaghetti plots puts
individual profiles into context, and may help identify outlying
individuals for further inspection. <!--END_EXPLANATION--></p>
<pre class="r"><code>pd_data_rep_by_trt &lt;- list()
for(id in unique(pd_data$ID)){
  indiv_data &lt;- pd_data %&gt;% subset(ID == id)
  itrtact = unique(indiv_data$TRTACT_low2high)
  
  pd_data_rep_by_trt[[as.character(id)]] &lt;- pd_data %&gt;% 
        subset(TRTACT_low2high == itrtact) %&gt;% 
        mutate(ID_rep_by_trt = ID, ID = id)
}
pd_data_rep_by_trt &lt;- bind_rows(pd_data_rep_by_trt)

gg &lt;- ggplot(mapping = aes(x = TIME, y = LIDV)) 
gg &lt;- gg + geom_line(data = pd_data_rep_by_trt, 
                     aes(group = ID_rep_by_trt), 
                     size = 1, color = rgb(0.5, 0.5, 0.5), alpha = 0.3)
gg &lt;- gg + geom_line(data = pd_data, 
                     aes(group = ID), size = 1)
gg &lt;- gg + xgx_scale_y_log10()
gg &lt;- gg + xgx_scale_x_time_units(units_dataset = time_units_dataset, 
                                  units_plot    = time_units_plot)
gg &lt;- gg + labs(y = pd_label)
gg &lt;- gg + theme(legend.position = &quot;none&quot;)
gg &lt;- gg + theme(panel.grid.minor.x = ggplot2::element_line(color = rgb(0.9, 0.9, 0.9)), 
                 panel.grid.minor.y = ggplot2::element_line(color = rgb(0.9, 0.9, 0.9)))
gg &lt;- gg + facet_wrap(~ID + TRTACT_low2high, 
                ncol = 10)
gg &lt;- gg + xgx_annotate_status(status, fontsize = 4, color = rgb(0.5, 0.5, 1))
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
</div>
<div id="explore-covariate-effects-on-pd" class="section level2">
<h2>Explore covariate effects on PD</h2>
<!--START_EXPLANATION-->
<p>Stratify by covariates of interest to explore whether any key
covariates impact response. For examples of plots and code startifying
by covariate, see <a
href="Single_Ascending_Dose_PK.html#explore_covariate_effects_on_pk">Single
Ascending Dose Covariate Section</a></p>
<p><strong>Warning</strong> Be careful of interpreting covariate effects
on PD. Covariate effects on PD could be the result of covariate effects
on PK transfering to PD through the PK/PD relationship.</p>
</div>
<div id="explore-dose-response-relationship" class="section level2">
<h2>Explore Dose-Response Relationship</h2>
<p>One of the key questions when looking at PD markers is to determine
if there is a dose-response relationship, and if there is, what dose is
necessary to achieve the desired effect? Simple dose-response plots can
give insight into these questions.</p>
<div id="pd-marker-by-dose-for-endpoint-of-interest-mean-95-ci-by-dose"
class="section level3">
<h3>PD marker by Dose, for endpoint of interest, mean (95% CI) by
Dose</h3>
<p>Plot PD marker against dose. Using summary statistics can be helpful,
e.g. Mean +/- SE, or median, 5th &amp; 95th percentiles.</p>
<p>Here are some questions to ask yourself when looking at Dose-Response
plots: Do you see any relationship? Does response increase (decrease)
with increasing dose? Are you able to detect a plateau or emax (emin) on
the effect? If so, around what dose does this occur?</p>
<p><strong>Warning:</strong> Even if you don’t see an Emax, that doesn’t
mean there isn’t one. Be very careful about using linear models for
Dose-Response relationships. Extrapolation outside of the observed dose
range could indicate a higher dose is always better (even if it isn’t).
<!--END_EXPLANATION--></p>
<pre class="r"><code>pd_data_to_plot &lt;- pd_data %&gt;% subset(PROFDAY %in% c(SS_PROFDAY))

gg &lt;- ggplot(data = pd_data_to_plot, aes(x = DOSE, y = LIDV))
gg &lt;- gg + xgx_stat_ci(conf_level = .95, geom = list(&quot;point&quot;,&quot;errorbar&quot;))
gg &lt;- gg + xgx_geom_smooth_emax()
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + facet_grid(~DAY_label)
gg &lt;- gg + labs(x = dose_label, y = pd_label)
gg &lt;- gg + scale_x_continuous(breaks = unique(pd_data_to_plot$DOSE))
gg &lt;- gg + xgx_annotate_status(status)

#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
</div>
<div id="pd-marker-by-dose-faceted-by-visit-mean-95-ci-by-dose"
class="section level3">
<h3>PD marker by Dose, faceted by visit, mean (95% CI) by Dose</h3>
<!--START_EXPLANATION-->
<p>Sometimes the crossectional Dose-Response curve which looks only at
one timepoint defined in the protocol can obscure certain
characteristics of the dose-response relationship. For example, if the
response variable is much delayed compared to PK the maximal PD effect
could occur much later than steady state PK is achieved. Looking only at
the defined clinical endpoint has the potential miss this, especially in
early clinical trials before the time course of the effect has been
characterized. Looking at longitudinal PD over time (as in previous
sections above) can help to uncover these trends. It may also be helpful
to plot the cross-sectional Dose-Response curves for different time
points throughout the study. <!--END_EXPLANATION--></p>
<pre class="r"><code>pd_data_to_plot &lt;- pd_data %&gt;% subset(PROFDAY %in% PD_PROFDAYS)


gg &lt;- ggplot(data = pd_data_to_plot, aes(x = DOSE, y = LIDV))
gg &lt;- gg + xgx_stat_ci(conf_level = .95, geom = list(&quot;point&quot;,&quot;errorbar&quot;))
gg &lt;- gg + xgx_geom_smooth_emax()
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + facet_grid(~DAY_label)
gg &lt;- gg + labs(x = dose_label, y = pd_label)
gg &lt;- gg + scale_x_continuous(breaks = seq(0, 1600, 400))
gg &lt;- gg + xgx_annotate_status(status)

#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>
</div>
<div id="explore-covariate-effects-on-dose-response-relationship"
class="section level3">
<h3>Explore covariate effects on Dose-Response relationship</h3>
<pre class="r"><code>pd_data_to_plot &lt;- pd_data %&gt;% subset(PROFDAY %in% c(0, SS_PROFDAY))

gg &lt;- ggplot(data = pd_data_to_plot, aes(x = DOSE , y = LIDV, color = SEX))
gg &lt;- gg + xgx_stat_ci(conf_level = .95, position = position_dodge(width = 100))
gg &lt;- gg + guides(color = guide_legend(&quot;&quot;), fill = guide_legend(&quot;&quot;))
gg &lt;- gg + facet_grid(~DAY_label)
gg &lt;- gg + labs(x = dose_label, y = pd_label)
gg &lt;- gg + scale_x_continuous(breaks = seq(0, 1600, 400))
gg &lt;- gg + xgx_annotate_status(status)

#if saving copy of figure, replace xgx_annotate lines with xgx_save() shown below:
#xgx_save(width, height, dirs, &quot;filename_main&quot;, status)
print(gg)</code></pre>
<p><img src="Multiple_Ascending_Dose_PD_continuous_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
</div>
</div>
<div id="r-session-info" class="section level2">
<h2>R Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Red Hat Enterprise Linux Server 7.9 (Maipo)
## 
## Matrix products: default
## BLAS/LAPACK: /CHBS/apps/EB/software/imkl/2019.1.144-gompi-2019a/compilers_and_libraries_2019.1.144/linux/mkl/lib/intel64_lin/libmkl_gf_lp64.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8   
##  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] nlme_3.1-160      emmeans_1.6.3     brms_2.18.0       Rcpp_1.0.9        DoseFinding_1.0-1 mvtnorm_1.1-3     lattice_0.20-45   RxODE_1.1.1      
##  [9] survminer_0.4.9   ggpubr_0.4.0      survival_3.4-0    knitr_1.40        broom_1.0.1       caTools_1.18.2    DT_0.26           forcats_0.5.2    
## [17] stringr_1.4.1     purrr_0.3.5       readr_2.1.3       tibble_3.1.8      tidyverse_1.3.2   xgxr_1.1.1        zoo_1.8-11        gridExtra_2.3    
## [25] tidyr_1.2.1       dplyr_1.0.10      ggplot2_3.3.6    
## 
## loaded via a namespace (and not attached):
##   [1] utf8_1.2.2           lme4_1.1-30          tidyselect_1.2.0     htmlwidgets_1.5.4    grid_4.1.0           munsell_0.5.0        codetools_0.2-18    
##   [8] interp_1.1-2         miniUI_0.1.1.1       withr_2.5.0          Brobdingnag_1.2-9    colorspace_2.0-3     highr_0.9            rstudioapi_0.14     
##  [15] stats4_4.1.0         DescTools_0.99.42    ggsignif_0.6.2       bayesplot_1.9.0      labeling_0.4.2       rstan_2.21.7         KMsurv_0.1-5        
##  [22] farver_2.1.1         bridgesampling_1.1-2 TH.data_1.1-1        coda_0.19-4          vctrs_0.5.0          generics_0.1.3       xfun_0.34           
##  [29] R6_2.5.1             markdown_1.2         gamm4_0.2-6          projpred_2.0.2       rex_1.2.1            bitops_1.0-7         cachem_1.0.6        
##  [36] reshape_0.8.8        PreciseSums_0.5      assertthat_0.2.1     promises_1.2.0.1     lotri_0.4.2          scales_1.2.1         multcomp_1.4-20     
##  [43] nnet_7.3-17          googlesheets4_1.0.1  rootSolve_1.8.2.2    gtable_0.3.1         processx_3.7.0       lmom_2.8             sandwich_3.0-2      
##  [50] rlang_1.0.6          splines_4.1.0        rstatix_0.7.0        lazyeval_0.2.2       gargle_1.2.1         inline_0.3.19        checkmate_2.1.0     
##  [57] reshape2_1.4.4       yaml_2.3.6           abind_1.4-5          modelr_0.1.9         threejs_0.3.3        crosstalk_1.2.0      backports_1.4.1     
##  [64] rsconnect_0.8.28     httpuv_1.6.6         Hmisc_4.7-0          tensorA_0.36.2       tools_4.1.0          ellipsis_0.3.2       jquerylib_0.1.4     
##  [71] posterior_1.3.1      RColorBrewer_1.1-3   proxy_0.4-26         ggridges_0.5.4       plyr_1.8.7           base64enc_0.1-3      progress_1.2.2      
##  [78] RCurl_1.98-1.4       ps_1.7.1             prettyunits_1.1.1    rpart_4.1.16         deldir_1.0-6         haven_2.5.1          cluster_2.1.3       
##  [85] fs_1.5.2             magrittr_2.0.3       data.table_1.14.2    openxlsx_4.2.4       colourpicker_1.1.1   reprex_2.0.2         googledrive_2.0.0   
##  [92] matrixStats_0.62.0   stringfish_0.15.7    shinyjs_2.1.0        hms_1.1.2            qs_0.25.3            mime_0.12            evaluate_0.17       
##  [99] xtable_1.8-4         shinystan_2.6.0      rio_0.5.27           jpeg_0.1-9           readxl_1.4.1         rstantools_2.2.0     compiler_4.1.0      
## [106] crayon_1.5.2         minqa_1.2.4          StanHeaders_2.21.0-7 htmltools_0.5.3      mgcv_1.8-41          later_1.3.0          tzdb_0.3.0          
## [113] Formula_1.2-4        expm_0.999-6         Exact_2.1            RcppParallel_5.1.5   lubridate_1.8.0      DBI_1.1.3            RApiSerialize_0.1.0 
## [120] dbplyr_2.2.1         MASS_7.3-58.1        boot_1.3-28          sys_3.4              Matrix_1.5-1         car_3.0-11           cli_3.4.1           
## [127] igraph_1.3.5         parallel_4.1.0       pkgconfig_2.0.3      km.ci_0.5-2          foreign_0.8-82       binom_1.1-1          xml2_1.3.3          
## [134] dygraphs_1.1.1.6     bslib_0.4.0          estimability_1.3     minpack.lm_1.2-1     rvest_1.0.3          callr_3.7.2          distributional_0.3.1
## [141] digest_0.6.30        rmarkdown_2.17       cellranger_1.1.0     survMisc_0.5.5       htmlTable_2.2.1      Deriv_4.1.3          gld_2.6.2           
## [148] dparser_1.3.1-5      curl_4.3.3           gtools_3.9.3         shiny_1.7.2          nloptr_2.0.3         lifecycle_1.0.3      jsonlite_1.8.3      
## [155] carData_3.0-4        fansi_1.0.3          pillar_1.8.1         loo_2.5.1            GGally_2.1.2         pkgbuild_1.3.1       fastmap_1.1.0       
## [162] httr_1.4.4           xts_0.12.2           glue_1.6.2           zip_2.2.0            shinythemes_1.2.0    png_0.1-7            pander_0.6.4        
## [169] class_7.3-19         stringi_1.7.8        sass_0.4.2           latticeExtra_0.6-30  memoise_2.0.1        e1071_1.7-8</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
