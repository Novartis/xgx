<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Alison Margolskee" />


<title>PKPD Datasets</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  .visible-sm-block {padding-top: 120px;}
  .visible-md-block {padding-top: 60px;}
  .visible-lg-block {padding-top: 0px;}
  
</style>


<span class=visible-sm-block> </span>
<span class=visible-md-block> </span>
<span class=visible-lg-block> </span>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">xGx</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-home"></span>
     
  </a>
</li>
<li>
  <a href="GuidingPrinciples.html">Guiding Principles</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datasets.html">Dataset Specifications</a>
    </li>
    <li>
      <a href="PKPD_Datasets.html">Master PK/PD Datasets used in creating example plots</a>
    </li>
    <li>
      <a href="Data_Checking.html">Data Checking</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dose-PK/Exposure
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Single_Ascending_Dose_PK.html">Single Ascending Dose - PK</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PK.html">Multiple Ascending Dose - PK</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PK_KeyPlots.html">Example using realistic data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dose-PD/Efficacy/Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Multiple_Ascending_Dose_PD_continuous.html">Continuous</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_binary.html">Binary Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_ordinal.html">Ordinal Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_count.html">Count Data</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_time_to_event.html">Time to Event</a>
    </li>
    <li>
      <a href="Oncology_Efficacy_Plots.html">Oncology Efficacy Endpoints (RECIST)</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PD_real_example.html">PD/Efficacy Example using realistic data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    PK-PD/Efficacy/Safety
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_continuous.html">Continuous</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_binary.html">Binary Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_ordinal.html">Ordinal Response</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_count.html">Count Data</a>
    </li>
    <li>
      <a href="Multiple_Ascending_Dose_PKPD_time_to_event.html">Time to Event</a>
    </li>
    <li>
      <a href="Adverse_Events.html">Adverse Events</a>
    </li>
  </ul>
</li>
<li>
  <a href="Resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<style type="text/css">
  .visible-sm-block {padding-top: 120px;}
  .visible-md-block {padding-top: 60px;}
  .visible-lg-block {padding-top: 0px;}
  .navbar-image {width: 150px;}
  .warning { 
      font-size: 200% ; 
      color: red; 
      padding-top: 200px;
    }
    }
  
  @media (min-width: 992px) and (max-width: 1200px){
    .navbar-image {width: 19%;}
    
    .section h1 {
  padding-top: 110px;
  margin-top: -110px;
  }

  .section h2 {
  padding-top: 110px;
  margin-top: -110px;
  }
  
    .section h3 {
  padding-top: 110px;
  margin-top: -110px;
  }
  }
  
  
  @media (min-width: 768px) and (max-width: 991px){

    .navbar-image {width: 19%;}
    
    .section h1 {
  padding-top: 160px;
  margin-top: -160px;
  }

  .section h2 {
  padding-top: 160px;
  margin-top: -160px;
  }
  
    .section h3 {
  padding-top: 160px;
  margin-top: -160px;
  }
  }
  
@media (max-width: 768px){
  .navbar-image {width: 19%;}

}
  

</style>


<!--[if IE]>
<p/>
<p/>
<p class="warning"> Dear Internet Explorer user: Please ensure compatibility view settings are turned OFF in order to view this website propertly. For best results, use Chrome. <br/>
<p/>
 <![endif]--> 


<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">PKPD Datasets</h1>
<h4 class="author">Alison Margolskee</h4>

</div>


<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This page describes the master PKPD analysis datasets used in the
majority of the plots on this site. The datasets were generated using
RxODE. Data specifications can be accessed on <a
href="Datasets.html">Datasets</a>. One dataset was created for single
ascending dose PK and another dataset for multiple ascending dose PK and
PD. Explore the datasets in the tables below, or download from the
following links:</p>
<ul>
<li><a href="Data/Single_Ascending_Dose_Dataset2.csv">simulated dataset
of single ascending dose PK</a></li>
<li><a href="Data/Multiple_Ascending_Dose_Dataset2.csv">master PKPD
dataset for multiple ascending dose PK and PD</a></li>
</ul>
</div>
<div id="setup" class="section level2">
<h2>Setup</h2>
<pre class="r"><code>library(dplyr)
library(RxODE)</code></pre>
</div>
<div id="dataset-generation" class="section level2">
<h2>Dataset Generation</h2>
<div id="indirect-response-system" class="section level3">
<h3>Indirect response system</h3>
<pre class="r"><code>ode &lt;- &quot;
Concentration = centr/V2;
C3 = peri/V3;
C4 = peri2/V4;
d/dt(depot) = -KA*depot;
d/dt(centr) = KA*depot - (CL+Q+Q2)*Concentration + Q*C3 + Q2*C4;
d/dt(peri) =                    Q*Concentration - Q*C3;
d/dt(peri2) =                   Q2*Concentration - Q2*C4;
d/dt(eff) = Kin*(1+Emax*Concentration/(EC50 + Concentration)) - Kout*(1)*eff;
&quot;

work &lt;- tempfile(&quot;Rx_intro-&quot;)
mod1 &lt;- RxODE(model = ode, modName = &quot;mod1&quot;)</code></pre>
<pre><code>## In file included from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Core:88,
##                  from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Dense:1,
##                  from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13,
##                  from &lt;command-line&gt;:
## /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name ‘namespace’
##  namespace Eigen {
##  ^~~~~~~~~
## /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:17: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘{’ token
##  namespace Eigen {
##                  ^
## In file included from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Dense:1,
##                  from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13,
##                  from &lt;command-line&gt;:
## /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Core:96:10: fatal error: complex: No such file or directory
##  #include &lt;complex&gt;
##           ^~~~~~~~~
## compilation terminated.
## make: *** [mod1_.o] Error 1</code></pre>
<pre><code>## error building model</code></pre>
<pre><code>## gcc -I&quot;/CHBS/apps/EB/software/R/4.1.0-gomkl-2019a-RAN/lib64/R/include&quot; -DNDEBUG   -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/Rcpp/include/&quot;  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/&quot;  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/unsupported&quot;  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/BH/include&quot; -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/src/&quot;  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/&quot;  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppParallel/include/&quot;  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/CHBS/apps/EB/software/PostgreSQL/11.3-gomkl-2019a-Python-3.7.2/include -I/CHBS/apps/EB/software/librsvg/2.40.15-gomkl-2019a/include -I/CHBS/apps/EB/software/unixODBC/2.3.7-gomkl-2019a/include -I/CHBS/apps/EB/software/GDAL/3.0.0-gomkl-2019a-Python-3.7.2/include -I/CHBS/apps/EB/software/Python/3.7.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/UDUNITS/2.2.26-GCCcore-8.2.0-nv/include -I/CHBS/apps/EB/software/zlib/1.2.11-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/XZ/5.2.4-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/SQLite/3.27.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/NLopt/2.6.1-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/ncurses/6.1-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libsndfile/1.0.28-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libxml2/2.9.8-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/HDF5/1.10.5-gompi-2019a/include -I/CHBS/apps/EB/software/FFTW/3.3.8-gompi-2019a/include -I/CHBS/apps/EB/software/ZeroMQ/4.3.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/poppler/0.90.1-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/OpenJPEG/2.3.1-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/MPFR/4.0.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/Mesa/19.0.1-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/nodejs/10.15.3-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libGLU/9.0.0-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libgit2/1.0.0-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/JAGS/4.3.0-gomkl-2019a/include -I/CHBS/apps/EB/software/GSL/2.5-GCC-8.2.0-2.31.1/include -I/CHBS/apps/EB/software/GMP/6.1.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/GLPK/4.65-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/OpenSSL/1.1.1b-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/ImageMagick/7.0.8-46-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/X11/20190311-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/Tk/8.6.9-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/Pango/1.43.0-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/LibTIFF/4.0.10-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libpng/1.6.36-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libjpeg-turbo/2.0.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/ICU/64.2-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/Java/11.0.2/include -I/CHBS/apps/EB/software/cairo/1.16.0-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/cURL/7.63.0-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/PCRE2/10.33-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/bzip2/1.0.6-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/libreadline/8.0-GCCcore-8.2.0/include -I/CHBS/apps/EB/software/imkl/2019.1.144-gompi-2019a/mkl/include  -O3  -I&quot;/CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RxODE/include&quot; -fpic  -O2 -ftree-vectorize -march=ivybridge -fno-math-errno  -c mod1_.c -o mod1_.o</code></pre>
<pre><code>## In file included from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Core:88,
##                  from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Dense:1,
##                  from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13,
##                  from &lt;command-line&gt;:
## /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name ‘namespace’
##  namespace Eigen {
##  ^~~~~~~~~
## /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:17: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘{’ token
##  namespace Eigen {
##                  ^
## In file included from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Dense:1,
##                  from /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13,
##                  from &lt;command-line&gt;:
## /CHBS/apps/EB/software/R-bundle-Novartis/0.5-gomkl-2019a-R-4.1.0/RcppEigen/include/Eigen/Core:96:10: fatal error: complex: No such file or directory
##  #include &lt;complex&gt;
##           ^~~~~~~~~
## compilation terminated.
## make: *** [mod1_.o] Error 1</code></pre>
<pre><code>## #define _getRxSolve_ _rxmod1_df6074d67f56e0417f0b97582bdb6a190
## #define simeps _rxmod1_df6074d67f56e0417f0b97582bdb6a191
## #define simeta _rxmod1_df6074d67f56e0417f0b97582bdb6a192
## #define _solveData _rxmod1_df6074d67f56e0417f0b97582bdb6a193
## #define _assign_ptr _rxmod1_df6074d67f56e0417f0b97582bdb6a194
## #define _rxRmModelLib _rxmod1_df6074d67f56e0417f0b97582bdb6a195
## #define _rxGetModelLib _rxmod1_df6074d67f56e0417f0b97582bdb6a196
## #define _old_c _rxmod1_df6074d67f56e0417f0b97582bdb6a197
## #define _ptrid _rxmod1_df6074d67f56e0417f0b97582bdb6a198
## #define _rxIsCurrentC _rxmod1_df6074d67f56e0417f0b97582bdb6a199
## #define _sumPS _rxmod1_df6074d67f56e0417f0b97582bdb6a1910
## #define _prodPS _rxmod1_df6074d67f56e0417f0b97582bdb6a1911
## #define _prodType _rxmod1_df6074d67f56e0417f0b97582bdb6a1912
## #define _sumType _rxmod1_df6074d67f56e0417f0b97582bdb6a1913
## #define _update_par_ptr _rxmod1_df6074d67f56e0417f0b97582bdb6a1914
## #define _getParCov _rxmod1_df6074d67f56e0417f0b97582bdb6a1915
## #define linCmtA _rxmod1_df6074d67f56e0417f0b97582bdb6a1916
## #define linCmtC _rxmod1_df6074d67f56e0417f0b97582bdb6a1917
## #define linCmtB _rxmod1_df6074d67f56e0417f0b97582bdb6a1918
## #define _RxODE_rxAssignPtr _rxmod1_df6074d67f56e0417f0b97582bdb6a1919
## #define _rxQr _rxmod1_df6074d67f56e0417f0b97582bdb6a1920
## #define phi _rxmod1_df6074d67f56e0417f0b97582bdb6a1921
## #define logit _rxmod1_df6074d67f56e0417f0b97582bdb6a1922
## #define expit _rxmod1_df6074d67f56e0417f0b97582bdb6a1923
## #define gammap _rxmod1_df6074d67f56e0417f0b97582bdb6a1924
## #define gammaq _rxmod1_df6074d67f56e0417f0b97582bdb6a1925
## #define lowergamma _rxmod1_df6074d67f56e0417f0b97582bdb6a1926
## #define uppergamma _rxmod1_df6074d67f56e0417f0b97582bdb6a1927
## #define gammapInv _rxmod1_df6074d67f56e0417f0b97582bdb6a1928
## #define gammapDer _rxmod1_df6074d67f56e0417f0b97582bdb6a1929
## #define gammapInva _rxmod1_df6074d67f56e0417f0b97582bdb6a1930
## #define gammaqInv _rxmod1_df6074d67f56e0417f0b97582bdb6a1931
## #define gammaqInva _rxmod1_df6074d67f56e0417f0b97582bdb6a1932
## #define rxnorm _rxmod1_df6074d67f56e0417f0b97582bdb6a1933
## #define rxnormV _rxmod1_df6074d67f56e0417f0b97582bdb6a1934
## #define rxbinom _rxmod1_df6074d67f56e0417f0b97582bdb6a1935
## #define rxcauchy _rxmod1_df6074d67f56e0417f0b97582bdb6a1936
## #define rxchisq _rxmod1_df6074d67f56e0417f0b97582bdb6a1937
## #define rxexp _rxmod1_df6074d67f56e0417f0b97582bdb6a1938
## #define rxf _rxmod1_df6074d67f56e0417f0b97582bdb6a1939
## #define rxgeom _rxmod1_df6074d67f56e0417f0b97582bdb6a1940
## #define rxgamma _rxmod1_df6074d67f56e0417f0b97582bdb6a1941
## #define rxbeta _rxmod1_df6074d67f56e0417f0b97582bdb6a1942
## #define rxpois _rxmod1_df6074d67f56e0417f0b97582bdb6a1943
## #define rxt_ _rxmod1_df6074d67f56e0417f0b97582bdb6a1944
## #define rxunif _rxmod1_df6074d67f56e0417f0b97582bdb6a1945
## #define rxweibull _rxmod1_df6074d67f56e0417f0b97582bdb6a1946
## #define rinorm _rxmod1_df6074d67f56e0417f0b97582bdb6a1947
## #define rinormV _rxmod1_df6074d67f56e0417f0b97582bdb6a1948
## #define ribinom _rxmod1_df6074d67f56e0417f0b97582bdb6a1949
## #define ricauchy _rxmod1_df6074d67f56e0417f0b97582bdb6a1950
## #define richisq _rxmod1_df6074d67f56e0417f0b97582bdb6a1951
## #define riexp _rxmod1_df6074d67f56e0417f0b97582bdb6a1952
## #define rif _rxmod1_df6074d67f56e0417f0b97582bdb6a1953
## #define rigeom _rxmod1_df6074d67f56e0417f0b97582bdb6a1954
## #define rigamma _rxmod1_df6074d67f56e0417f0b97582bdb6a1955
## #define ribeta _rxmod1_df6074d67f56e0417f0b97582bdb6a1956
## #define ripois _rxmod1_df6074d67f56e0417f0b97582bdb6a1957
## #define rit_ _rxmod1_df6074d67f56e0417f0b97582bdb6a1958
## #define riunif _rxmod1_df6074d67f56e0417f0b97582bdb6a1959
## #define riweibull _rxmod1_df6074d67f56e0417f0b97582bdb6a1960
## #define _compareFactorVal _rxmod1_df6074d67f56e0417f0b97582bdb6a1961
## #define _sum _rxmod1_df6074d67f56e0417f0b97582bdb6a1962
## #define _sign _rxmod1_df6074d67f56e0417f0b97582bdb6a1963
## #define _prod _rxmod1_df6074d67f56e0417f0b97582bdb6a1964
## #define _max _rxmod1_df6074d67f56e0417f0b97582bdb6a1965
## #define _min _rxmod1_df6074d67f56e0417f0b97582bdb6a1966
## #define _transit4P _rxmod1_df6074d67f56e0417f0b97582bdb6a1967
## #define _transit3P _rxmod1_df6074d67f56e0417f0b97582bdb6a1968
## #define _assignFuns0 _rxmod1_df6074d67f56e0417f0b97582bdb6a1969
## #define _assignFuns _rxmod1_df6074d67f56e0417f0b97582bdb6a1970
## #include &lt;RxODE_model_shared.h&gt;
## #define __MAX_PROD__ 0
## #define _CMT CMT
## #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {V2 = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {V3 = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {V4 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {KA = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {CL = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {Q = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {Q2 = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {Kin = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {Emax = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {EC50 = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {Kout = _PP[10];}; }
## #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {V2 = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {V3 = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {V4 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {KA = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {CL = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {Q = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {Q2 = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {Kin = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {Emax = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {EC50 = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {Kout = _PP[10];}; }
## #include &quot;extraC.h&quot;
## _getRxSolve_t _getRxSolve_;
## _simfun simeps;
## _simfun simeta;
## rx_solve *_solveData=NULL;
## RxODE_assign_ptr _assign_ptr=NULL;
## _rxRmModelLibType _rxRmModelLib=NULL;
## _rxGetModelLibType _rxGetModelLib=NULL;
## RxODE_ode_solver_old_c _old_c=NULL;
## RxODE_fn0i _ptrid=NULL;
## _rxIsCurrentC_type _rxIsCurrentC=NULL;
## _rxSumType _sumPS=NULL;
## _rxProdType _prodPS=NULL;
## RxODE_fn0i _prodType=NULL;
## RxODE_fn0i _sumType=NULL;
## _update_par_ptr_p _update_par_ptr=NULL;
## _getParCov_p _getParCov=NULL;
## linCmtA_p linCmtA;
## linCmtA_p linCmtC;
## linCmtB_p linCmtB;
## _rx_asgn _RxODE_rxAssignPtr=NULL;
## _rx_asgn _rxQr=NULL;
## RxODE_fn phi;
## RxODE_fn3 logit;
## RxODE_fn3 expit;
## RxODE_fn2 gammap;
## RxODE_fn2 gammaq;
## RxODE_fn2 lowergamma;
## RxODE_fn2 uppergamma;
## RxODE_fn2 gammapInv;
## RxODE_fn2 gammapDer;
## RxODE_fn2 gammapInva;
## RxODE_fn2 gammaqInv;
## RxODE_fn2 gammaqInva;
## RxODEi_fn2 rxnorm;
## RxODEi_fn2 rxnormV;
## RxODEi_rxbinom rxbinom;
## RxODEi_fn2 rxcauchy;
## RxODEi_fn rxchisq;
## RxODEi_fn rxexp;
## RxODEi_fn2 rxf;
## RxODEi_ifn rxgeom;
## RxODEi_fn2 rxgamma;
## RxODEi_fn2 rxbeta;
## RxODEi_ifn rxpois;
## RxODEi_fn rxt_;
## RxODEi_fn2 rxunif;
## RxODEi_fn2 rxweibull;
## RxODEi2_fn2 rinorm;
## RxODEi2_fn2 rinormV;
## RxODEi2_ribinom ribinom;
## RxODEi2_fn2 ricauchy;
## RxODEi2_fn richisq;
## RxODEi2_fn riexp;
## RxODEi2_fn2 rif;
## RxODEi2_ifn rigeom;
## RxODEi2_fn2 rigamma;
## RxODEi2_fn2 ribeta;
## RxODEi2_ifn ripois;
## RxODEi2_fn rit_;
## RxODEi2_fn2 riunif;
## RxODEi2_fn2 riweibull;
## RxODE_compareFactorVal_fn _compareFactorVal;
## double _prod(double *input, double *p, int type, int n, ...){
##   va_list valist;
##   va_start(valist, n);
##   for (unsigned int i = 0; i &lt; n; i++){
##     input[i] = va_arg(valist, double);
##   }
##   va_end(valist);
##   return _prodPS(input, p, n, type);
## }
## double _sum(double *input, double *pld, int m, int type, int n, ...){
##   va_list valist;
##   va_start(valist, n);
##   for (unsigned int i = 0; i &lt; n; i++){
##     input[i] = va_arg(valist, double);
##   }
##   va_end(valist);
##   double ret = _sumPS(input, n, pld, m, type);
##   if (type == 2 &amp;&amp; m &lt; 0){
##     for (int i = -m; i--;){
##       pld[i] = 0.0;
##     }
##   }
##   return ret;
## }
## double _sign(unsigned int n, ...) {
##   va_list valist;
##   va_start(valist, n);
##   double s = 1;
##   for (unsigned int i = 0; i &lt; n; i++) {
##     s = sign(va_arg(valist, double))*s;
##     if (s == 0){
##       break;
##     }
##   }
##   va_end(valist);
##   return s;
## }
## double _max(unsigned int n, ...) {
##   va_list valist;
##   va_start(valist, n);
##   double mx = NA_REAL;
##   double tmp = 0;
##   if (n &gt;= 1){
##     mx = va_arg(valist, double);
##     for (unsigned int i = 1; i &lt; n; i++) {
##       tmp = va_arg(valist, double);
##       if (tmp&gt;mx) mx=tmp;
##     }
##     va_end(valist);
##   }
##   return mx;
## }
## double _min(unsigned int n, ...){
##   va_list valist;
##   va_start(valist, n);
##   double mn = NA_REAL;
##   double tmp = 0;
##   if (n &gt;= 1){
##     mn = va_arg(valist, double);
##     for (unsigned int i = 1; i &lt; n; i++){
##       tmp = va_arg(valist, double);
##       if (tmp&lt;mn) mn=tmp;
##     }
##     va_end(valist);
##   }
##   return mn;
## }
## double _transit4P(double t, unsigned int id, double n, double mtt, double bio){
##   double ktr = (n+1)/mtt;
##   double lktr = log(n+1)-log(mtt);
##   double tc = (t-(_solveData-&gt;subjects[id].tlast));
##   return exp(log(bio*(_solveData-&gt;subjects[id].podo))+lktr+n*(lktr+log(tc))-ktr*(tc)-lgamma1p(n));
## }
## double _transit3P(double t, unsigned int id, double n, double mtt){
##   double ktr = (n+1)/mtt;
##   double lktr = log(n+1)-log(mtt);
##   double tc = (t-(_solveData-&gt;subjects[id].tlast));
##   return exp(log(_solveData-&gt;subjects[id].podo)+lktr+n*(lktr+log(tc))-ktr*(tc)-lgamma1p(n));
## }
## void _assignFuns0() {
##   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable(&quot;RxODE&quot;,&quot;getRxSolve_&quot;);
##   _assign_ptr=(RxODE_assign_ptr) R_GetCCallable(&quot;RxODE&quot;,&quot;RxODE_assign_fn_pointers&quot;);
##   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable(&quot;RxODE&quot;,&quot;rxRmModelLib&quot;);
##   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable(&quot;RxODE&quot;,&quot;rxGetModelLib&quot;);
##   _RxODE_rxAssignPtr=(_rx_asgn)R_GetCCallable(&quot;RxODE&quot;,&quot;_RxODE_rxAssignPtr&quot;);
##   _rxQr=(_rx_asgn)R_GetCCallable(&quot;RxODE&quot;,&quot;_RxODE_rxQr&quot;);
##   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable(&quot;RxODE&quot;,&quot;rxIsCurrentC&quot;);
##   _sumPS  = (_rxSumType) R_GetCCallable(&quot;PreciseSums&quot;,&quot;PreciseSums_sum_r&quot;);
##   _prodPS = (_rxProdType) R_GetCCallable(&quot;PreciseSums&quot;,&quot;PreciseSums_prod_r&quot;);
##   _prodType=(RxODE_fn0i)R_GetCCallable(&quot;PreciseSums&quot;, &quot;PreciseSums_prod_get&quot;);
##   _sumType=(RxODE_fn0i)R_GetCCallable(&quot;PreciseSums&quot;, &quot;PreciseSums_sum_get&quot;);
##   _ptrid=(RxODE_fn0i)R_GetCCallable(&quot;RxODE&quot;, &quot;RxODE_current_fn_pointer_id&quot;);
##   linCmtA=(linCmtA_p)R_GetCCallable(&quot;RxODE&quot;, &quot;linCmtA&quot;);
##   linCmtB=(linCmtB_p)R_GetCCallable(&quot;RxODE&quot;, &quot;linCmtB&quot;);
##   linCmtC=(linCmtA_p)R_GetCCallable(&quot;RxODE&quot;, &quot;linCmtC&quot;);
##     
##   rxnorm = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;, &quot;rxnorm&quot;);
##   rxnormV = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;, &quot;rxnormV&quot;);
##   rxbinom = (RxODEi_rxbinom)R_GetCCallable(&quot;RxODE&quot;,&quot;rxbinom&quot;) ;
##   rxcauchy = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rxcauchy&quot;) ;
##   rxchisq = (RxODEi_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;rxchisq&quot;) ;
##   rxexp = (RxODEi_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;rxexp&quot;);
##   rxf = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rxf&quot;) ;
##   rxgeom = (RxODEi_ifn)R_GetCCallable(&quot;RxODE&quot;,&quot;rxgeom&quot;) ;
##   rxgamma = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rxgamma&quot;) ;
##   rxbeta = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rxbeta&quot;) ;
##   rxpois = (RxODEi_ifn)R_GetCCallable(&quot;RxODE&quot;,&quot;rxpois&quot;) ;
##   rxt_ = (RxODEi_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;rxt_&quot;) ;
##   rxunif = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rxunif&quot;) ;
##   rxweibull = (RxODEi_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rxweibull&quot;);
##   rinorm = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;, &quot;rinorm&quot;);
##   rinormV = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;, &quot;rinormV&quot;);
##   ribinom = (RxODEi2_ribinom)R_GetCCallable(&quot;RxODE&quot;,&quot;ribinom&quot;) ;
##   ricauchy = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;ricauchy&quot;) ;
##   richisq = (RxODEi2_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;richisq&quot;) ;
##   riexp = (RxODEi2_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;riexp&quot;);
##   rif = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rif&quot;) ;
##   rigeom = (RxODEi2_ifn)R_GetCCallable(&quot;RxODE&quot;,&quot;rigeom&quot;) ;
##   rigamma = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;rigamma&quot;) ;
##   ribeta = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;ribeta&quot;) ;
##   ripois = (RxODEi2_ifn)R_GetCCallable(&quot;RxODE&quot;,&quot;ripois&quot;) ;
##   rit_ = (RxODEi2_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;rit_&quot;) ;
##   riunif = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;riunif&quot;) ;
##   riweibull = (RxODEi2_fn2)R_GetCCallable(&quot;RxODE&quot;,&quot;riweibull&quot;);
##     
##   phi = (RxODE_fn)R_GetCCallable(&quot;RxODE&quot;,&quot;phi&quot;);
##   gammap = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammap&quot;);
##   gammaq = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammaq&quot;);
##   gammapInv = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammapInv&quot;);
##   gammapInva = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammapInva&quot;);
##   gammaqInv = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammaqInv&quot;);
##   gammaqInva = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammaqInva&quot;);
##   uppergamma = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;uppergamma&quot;);
##   lowergamma = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;lowergamma&quot;);
##   gammapDer  = (RxODE_fn2) R_GetCCallable(&quot;RxODE&quot;,&quot;gammapDer&quot;);
##   logit = (RxODE_fn3) R_GetCCallable(&quot;RxODE&quot;, &quot;logit&quot;);
##   expit = (RxODE_fn3) R_GetCCallable(&quot;RxODE&quot;, &quot;expit&quot;);
##   simeta =(_simfun) R_GetCCallable(&quot;RxODE&quot;, &quot;simeta&quot;);
##   simeps =(_simfun) R_GetCCallable(&quot;RxODE&quot;, &quot;simeps&quot;);
##   _compareFactorVal=(RxODE_compareFactorVal_fn) R_GetCCallable(&quot;RxODE&quot;, &quot;compareFactorVal&quot;);
##   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable(&quot;RxODE&quot;,&quot;_update_par_ptr&quot;);
##   _getParCov = (_getParCov_p) R_GetCCallable(&quot;RxODE&quot;,&quot;_getParCov&quot;);
##   _solveData = _getRxSolve_();
## }
## void _assignFuns() {
##   if (_assign_ptr == NULL){
##     _assignFuns0();
##   }
## }
## extern void  mod1__ode_solver_solvedata (rx_solve *solve){
##   _solveData = solve;
## }
## extern rx_solve *mod1__ode_solver_get_solvedata(){
##   return _solveData;
## }
## SEXP mod1__model_vars();
## 
## 
## // prj-specific differential eqns
## void mod1__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)
## {
##   int _itwhile = 0;
##   (void)_itwhile;
##   int _cSub = _neq[1];
##   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;
##   (void)t;
##     double Concentration;
##   double centr;
##   double V2;
##   double C3;
##   double peri;
##   double V3;
##   double C4;
##   double peri2;
##   double V4;
##   double depot;
##   double KA;
##   double CL;
##   double Q;
##   double Q2;
##   double eff;
##   double Kin;
##   double Emax;
##   double EC50;
##   double Kout;
## 
##   (void)t;
##   (void)Concentration;
##   (void)centr;
##   (void)V2;
##   (void)C3;
##   (void)peri;
##   (void)V3;
##   (void)C4;
##   (void)peri2;
##   (void)V4;
##   (void)depot;
##   (void)KA;
##   (void)CL;
##   (void)Q;
##   (void)Q2;
##   (void)eff;
##   (void)Kin;
##   (void)Emax;
##   (void)EC50;
##   (void)Kout;
## 
##   Concentration = _PL[0];
##   C3 = _PL[1];
##   C4 = _PL[2];
## 
##   _update_par_ptr(__t, _cSub, _solveData, _idx);
##   V2 = _PP[0];
##   V3 = _PP[1];
##   V4 = _PP[2];
##   KA = _PP[3];
##   CL = _PP[4];
##   Q = _PP[5];
##   Q2 = _PP[6];
##   Kin = _PP[7];
##   Emax = _PP[8];
##   EC50 = _PP[9];
##   Kout = _PP[10];
## 
##   depot = __zzStateVar__[0]*((double)(_ON[0]));
##   centr = __zzStateVar__[1]*((double)(_ON[1]));
##   peri = __zzStateVar__[2]*((double)(_ON[2]));
##   peri2 = __zzStateVar__[3]*((double)(_ON[3]));
##   eff = __zzStateVar__[4]*((double)(_ON[4]));
## 
##   Concentration=centr/safe_zero(V2);
##   C3=peri/safe_zero(V3);
##   C4=peri2/safe_zero(V4);
##   __DDtStateVar__[0] = ((double)(_ON[0]))*(_IR[0] -KA*depot);
##   __DDtStateVar__[1] = ((double)(_ON[1]))*(_IR[1] + KA*depot-(CL+Q+Q2)*Concentration+Q*C3+Q2*C4);
##   __DDtStateVar__[2] = ((double)(_ON[2]))*(_IR[2] + Q*Concentration-Q*C3);
##   __DDtStateVar__[3] = ((double)(_ON[3]))*(_IR[3] + Q2*Concentration-Q2*C4);
##   __DDtStateVar__[4] = ((double)(_ON[4]))*(_IR[4] + Kin*(1+Emax*Concentration/safe_zero((EC50+Concentration)))-Kout*(1)*eff);
##   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;
## }
## 
## // Jacobian derived vars
## void mod1__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {
##   int _itwhile = 0;
##   (void)_itwhile;
##     int _cSub=_neq[1];
##   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;
##   (void)t;
##     (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;
## }
## // Functional based initial conditions.
## void mod1__inis(int _cSub, double *__zzStateVar__){
##   int _itwhile = 0;
##   (void)_itwhile;
##   
## }
## // prj-specific derived vars
## void mod1__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {
##     int _itwhile = 0;
##   (void)_itwhile;
##   double t = __t + _solveData-&gt;subjects[_cSub].curShift;
##   (void)t;
##     double  __DDtStateVar_0__;
##   double  __DDtStateVar_1__;
##   double  __DDtStateVar_2__;
##   double  __DDtStateVar_3__;
##   double  __DDtStateVar_4__;
##   double Concentration;
##   double centr;
##   double V2;
##   double C3;
##   double peri;
##   double V3;
##   double C4;
##   double peri2;
##   double V4;
##   double depot;
##   double KA;
##   double CL;
##   double Q;
##   double Q2;
##   double eff;
##   double Kin;
##   double Emax;
##   double EC50;
##   double Kout;
## 
##   (void)t;
##   (void)__DDtStateVar_0__;
##   (void)__DDtStateVar_1__;
##   (void)__DDtStateVar_2__;
##   (void)__DDtStateVar_3__;
##   (void)__DDtStateVar_4__;
##   (void)Concentration;
##   (void)centr;
##   (void)V2;
##   (void)C3;
##   (void)peri;
##   (void)V3;
##   (void)C4;
##   (void)peri2;
##   (void)V4;
##   (void)depot;
##   (void)KA;
##   (void)CL;
##   (void)Q;
##   (void)Q2;
##   (void)eff;
##   (void)Kin;
##   (void)Emax;
##   (void)EC50;
##   (void)Kout;
## 
##   Concentration = _PL[0];
##   C3 = _PL[1];
##   C4 = _PL[2];
## 
##   _update_par_ptr(__t, _cSub, _solveData, _idx);
##   V2 = _PP[0];
##   V3 = _PP[1];
##   V4 = _PP[2];
##   KA = _PP[3];
##   CL = _PP[4];
##   Q = _PP[5];
##   Q2 = _PP[6];
##   Kin = _PP[7];
##   Emax = _PP[8];
##   EC50 = _PP[9];
##   Kout = _PP[10];
## 
##   depot = __zzStateVar__[0]*((double)(_ON[0]));
##   centr = __zzStateVar__[1]*((double)(_ON[1]));
##   peri = __zzStateVar__[2]*((double)(_ON[2]));
##   peri2 = __zzStateVar__[3]*((double)(_ON[3]));
##   eff = __zzStateVar__[4]*((double)(_ON[4]));
## 
##   Concentration=centr/safe_zero(V2);
##   C3=peri/safe_zero(V3);
##   C4=peri2/safe_zero(V4);
##   __DDtStateVar_0__ = ((double)(_ON[0]))*(_IR[0] -KA*depot);
##   __DDtStateVar_1__ = ((double)(_ON[1]))*(_IR[1] + KA*depot-(CL+Q+Q2)*Concentration+Q*C3+Q2*C4);
##   __DDtStateVar_2__ = ((double)(_ON[2]))*(_IR[2] + Q*Concentration-Q*C3);
##   __DDtStateVar_3__ = ((double)(_ON[3]))*(_IR[3] + Q2*Concentration-Q2*C4);
##   __DDtStateVar_4__ = ((double)(_ON[4]))*(_IR[4] + Kin*(1+Emax*Concentration/safe_zero((EC50+Concentration)))-Kout*(1)*eff);
## 
##   _lhs[0]=Concentration;
##   _lhs[1]=C3;
##   _lhs[2]=C4;
## }
## // Functional based bioavailability
## double mod1__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){
##  return _amt;
## }
## // Functional based absorption lag
## double mod1__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){
##  return __t;
## }
## // Modeled zero-order rate
## double mod1__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){
##  return 0.0;
## }
## // Modeled zero-order duration
## double mod1__Dur(int _cSub,  int _cmt, double _amt, double __t){
##  return 0.0;
## }
## // Model Times
## void mod1__mtime(int _cSub, double *_mtime){
## }
## // Matrix Exponential (0)
## void mod1__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){
##   int _itwhile = 0;
##   (void)_itwhile;
##   double t = __t + _solveData-&gt;subjects[_cSub].curShift;
##   (void)t;
##   }
## // Inductive linearization Matf
## void mod1__IndF(int _cSub, double _t, double __t, double *_matf){
##  int _itwhile = 0;
##   (void)_itwhile;
##   double t = __t + _solveData-&gt;subjects[_cSub].curShift;
##   (void)t;
##   }
## extern SEXP mod1__model_vars(){
##   int pro=0;
##   SEXP _mv = PROTECT(_rxGetModelLib(&quot;mod1__model_vars&quot;));pro++;
##   if (!_rxIsCurrentC(_mv)){
##     SEXP hash    = PROTECT(allocVector(STRSXP, 1));pro++;
## #define __doBuf__  sprintf(buf, &quot;un]\&quot;BAAA@QRtHACAAAAAAAk_2AAAv7#aT)db_0NA)}H/&lt;Ws7YB~1t0]w}7YmY9RMj5AJ%%e8m@5OPdYnNPPRm)}Si}}5Va)rvP5*$b~)@D|$&gt;]x;{TM!H_&gt;54FD]aJVZLUwor_6A29z\&quot;y*oCXQ.r6)Xk&lt;%%sSCf%%Q|Z2p|Fq;Au^oq6M6jW(7|4rd6E[LQ&amp;BlSala|aSz4!!)tj}f,dotzUK6&lt;F1@!hd(r+TU`bZ%%8@UE&amp;0D&lt;WcK\?7d,L(n{.7tLnH`MibkD:hq0Qb676@\&quot;EgKcK,&gt;95`hG,!vf[a*&lt;XoXtIZjJej:5i]w.HDYR*\?2LNMh1QW/Lg#c%%/7vr|@!21jZV^(aQ+.av0Fir*W+\?\?`[#zz:lp^[ZlmV(j$U|oJ\?_)\?(W:`h=C&gt;IV^kq1K&gt;qP\?9tfqd[2BMF$)&amp;T;MNRCADH}d2ZC:&lt;gpLj7blAKJDQ@yQ&gt;8}uT2DPij&amp;&gt;hQ&lt;&lt;&gt;J3u@G}BD72l_\?TG2Z0)[MmlSazTw4{+3OEEsD&lt;~bO&gt;D*Yaw7cTCrJr]d/1Nt6M8m&amp;4Op=&amp;g$Sc;cnc:aD6@D;9WWdpl)DP!&amp;i|u_Qoqhd3Ez/^T/)|`Ne50L|Toh*~]g3*2E@7^V}p\&quot;3tR(*~[O2g%%|HlPznur1)WygMp.Uh68h\?M/8ecXc7LG5_IKY&amp;A.c[H^iBxAEm&gt;U+s}9Bt=qL9KFElScPoc,YbQU`]I{1B^ZmJjZ7g`)j9~o*;1#\&quot;\&quot;#&lt;L3++&gt;Y+sL15=!]ULNN6s`:lTkD4IJv)Jb|Qz&gt;^[gW9^rS}2,`.Ra}Hhq&lt;:c2m%%_zI6o1P$=Q[.i|^o[;]uIf$PN#vsQPfJvLYKT&gt;z`u+ki*4fVDgEJ)lRc)Oa3X@MTiDJ+ACdAeeFT\&quot;0@UOQw4Io0xo@Q3n6(W~/YVi*u\?3xb&amp;nc4=&lt;EUTP5^mamT&amp;P[0Q.vS\?8::[6KkpraYwS@txG\?SY}y$vrl)(ym&lt;1j*y}UkTo|+`_w$2Yxsr\?v%%[J])u_KHG:a.agC}HhXB\?vDt2rZBIer2i~,)*MkVHQez&gt;.+_fRhK}l]u_]H5f=VpqRyox8ACCtEN6\?vG.*rlGP[Z;a@05Ikwp;c:Ye(;t`(d2{\&quot;Wxp#q7M%%@8jT[t~9vaVpW7XIEH}\?b,al$@r}YC&quot;);
##     char buf[1124];
##     __doBuf__
## #undef __doBuf__
##     SET_STRING_ELT(hash, 0, mkChar(buf));
##     SEXP lst      = PROTECT(_rxQr(hash));pro++;
##     _assign_ptr(lst);
##     UNPROTECT(pro);
##     return lst;
##   } else {
##     UNPROTECT(pro);
##     return _mv;
##   }
## }
## extern void mod1__dydt_lsoda(int *neq, double *t, double *A, double *DADT)
## {
##   mod1__dydt(neq, *t, A, DADT);
## }
## extern int mod1__dydt_liblsoda(double __t, double *y, double *ydot, void *data)
## {
##   int *neq = (int*)(data);
##   mod1__dydt(neq, __t, y, ydot);
##   return(0);
## }
## extern void mod1__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){
##   // Update all covariate parameters
##   mod1__calc_jac(neq, *t, A, JAC, *nrowpd);
## }
## 
## //Create function to call from R&#39;s main thread that assigns the required functions. Sometimes they don&#39;t get assigned.
## extern void mod1__assignFuns(){
##   _assignFuns();
## }
## 
## //Initialize the dll to match RxODE&#39;s calls
## void R_init0_mod1_(){
##   // Get C callables on load; Otherwise it isn&#39;t thread safe
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__assignFuns&quot;, (DL_FUNC) mod1__assignFuns);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__inis&quot;,(DL_FUNC) mod1__inis);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__dydt&quot;,(DL_FUNC) mod1__dydt);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__calc_lhs&quot;,(DL_FUNC) mod1__calc_lhs);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__calc_jac&quot;,(DL_FUNC) mod1__calc_jac);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__dydt_lsoda&quot;, (DL_FUNC) mod1__dydt_lsoda);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__calc_jac_lsoda&quot;, (DL_FUNC) mod1__calc_jac_lsoda);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__ode_solver_solvedata&quot;, (DL_FUNC) mod1__ode_solver_solvedata);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__ode_solver_get_solvedata&quot;, (DL_FUNC) mod1__ode_solver_get_solvedata);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__F&quot;, (DL_FUNC) mod1__F);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__Lag&quot;, (DL_FUNC) mod1__Lag);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__Rate&quot;, (DL_FUNC) mod1__Rate);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__Dur&quot;, (DL_FUNC) mod1__Dur);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__mtime&quot;, (DL_FUNC) mod1__mtime);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__ME&quot;, (DL_FUNC) mod1__ME);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__IndF&quot;, (DL_FUNC) mod1__IndF);
##   R_RegisterCCallable(&quot;mod1_&quot;,&quot;mod1__dydt_liblsoda&quot;, (DL_FUNC) mod1__dydt_liblsoda);
## }
## //Initialize the dll to match RxODE&#39;s calls
## void R_init_mod1_(DllInfo *info){
##   // Get C callables on load; Otherwise it isn&#39;t thread safe
##   R_init0_mod1_();
##   static const R_CallMethodDef callMethods[]  = {
##     {&quot;mod1__model_vars&quot;, (DL_FUNC) &amp;mod1__model_vars, 0},
##     {NULL, NULL, 0}
##   };
## 
##   R_registerRoutines(info, NULL, callMethods, NULL, NULL);
##   R_useDynamicSymbols(info,FALSE);
##   _assignFuns0();
## 
## }
## 
## void R_unload_mod1_ (DllInfo *info){
##   // Free resources required for single subject solve.
##   SEXP _mv = PROTECT(_rxGetModelLib(&quot;mod1__model_vars&quot;));
##   if (!isNull(_mv)){
##     _rxRmModelLib(&quot;mod1__model_vars&quot;);
##   }
##   UNPROTECT(1);
## }</code></pre>
<pre><code>## Error: error building model</code></pre>
<pre class="r"><code>cat(gsub(pattern=&quot;\nConcentration&quot;,replacement=&quot;Concentration&quot;,x=gsub(pattern=&quot;;\n&quot;,replacement=&quot; \n&quot;, x = ode)))</code></pre>
<pre><code>## Concentration = centr/V2 
## C3 = peri/V3 
## C4 = peri2/V4 
## d/dt(depot) = -KA*depot 
## d/dt(centr) = KA*depot - (CL+Q+Q2)*Concentration + Q*C3 + Q2*C4 
## d/dt(peri) =                    Q*Concentration - Q*C3 
## d/dt(peri2) =                   Q2*Concentration - Q2*C4 
## d/dt(eff) = Kin*(1+Emax*Concentration/(EC50 + Concentration)) - Kout*(1)*eff</code></pre>
</div>
<div id="single-ascending-dose-pk-dataset" class="section level3">
<h3>Single Ascending Dose PK Dataset</h3>
<pre class="r"><code>set.seed(12345666)
ndose &lt;- 5
nsub &lt;- 10 # number of subproblems

SEX &lt;- rep(c(rep(&quot;Male&quot;,ceiling(nsub/2)),rep(&quot;Female&quot;,floor(nsub/2))),ndose)
WT0 &lt;- (SEX==&quot;Male&quot;)*runif(length(SEX),60,110)+(SEX==&quot;Female&quot;)*runif(length(SEX),50,100)
VCOV &lt;- (WT0/70)*(1-0.5*(SEX==&quot;Female&quot;))
CLCOV &lt;- (WT0/70)*(1-0.5*(SEX==&quot;Female&quot;))

CL &lt;- 0.02*exp(rnorm(nsub*ndose,0,.4^2))*CLCOV
KA &lt;- 0.5*exp(rnorm(nsub*ndose,0,.4^2))
V2 &lt;- 30*exp(rnorm(nsub*ndose,0,.4^2))*VCOV
DOSE &lt;- sort(rep(c(100,200,400,800,1600),nsub))
theta.all &lt;- 
  cbind(KA=KA, CL=CL, V2=V2,
        Q=10*CLCOV, V3=100*VCOV, V4 = 10000*VCOV, Q2 = 10*CLCOV,
        Kin=0.5, Kout=0.05, EC50 = 1, Emax = 4)

# Set nominal times for sampling schedule
SAMPLING &lt;- c(-0.1,0.1,0.5,1,2,4,8,12,18,23.9,36,47.9,71.9)

DOSING &lt;- c(0)
NT &lt;- data.frame(NT = c(SAMPLING, DOSING), label = c(rep(&quot;SAMPLING&quot;,length(SAMPLING)),rep(&quot;DOSING&quot;,length(DOSING))))
NT &lt;- NT[order(NT$NT),]

ev.all &lt;- list()
for(idose in 1:length(DOSE)){
  ev.all[[idose]] &lt;- eventTable(amount.units=&#39;mg&#39;, time.units=&#39;hours&#39;)
  # ev.all[[idose]]$add.dosing(dose = DOSE[idose], nbr.doses = 1, dosing.interval = 24)
  # ev.all[[idose]]$add.sampling(c(c(-0.1,0.1,0.5,1,2,4,8,12,18,23.9,36,47.9,71.9)))
  
  # Include some noise in the sampling &amp; dosing schedules
  temp &lt;- NT
  temp$time &lt;- cumsum(c(temp$NT[1] + 0.1*rnorm(1), abs(temp$NT[2:length(temp$NT)]-temp$NT[1:length(temp$NT)-1] + 0.1*rnorm(length(temp$NT)-1))))
  temp$time &lt;- temp$time - temp$time[temp$NT==0] # center at first dose
  
  ev.all[[idose]]$add.dosing(dose = DOSE[idose], start.time = temp$time[temp$label==&quot;DOSING&quot;])
  ev.all[[idose]]$add.sampling(temp$time[temp$label==&quot;SAMPLING&quot;])
  
}

x.all.df &lt;- NULL
ID = 0
for(i in 1:length(ev.all)){
  #   for(i in 1:nsub){
  ID = ID + 1
  theta &lt;- theta.all[i,]
  inits &lt;- c(depot = 0, centr = 0, peri = 0, peri2 = 0, eff=theta[&quot;Kin&quot;]/theta[&quot;Kout&quot;])
  x &lt;- mod1$solve(theta, ev.all[[i]], inits = inits)
  
  x.df &lt;- data.frame(x)
  x.df$NT &lt;- SAMPLING
  
  temp &lt;- data.frame(ev.all[[i]]$get.dosing())
  temp$NT &lt;- DOSING
  
  temp[,setdiff(names(x.df),names(temp))]&lt;- NA
  x.df[,setdiff(names(temp),names(x.df))]&lt;- NA
  x.df &lt;- rbind(x.df,temp)
  
  x.df$ID &lt;- ID
  x.df$DOSE &lt;- DOSE[i]
  x.df$WT0 &lt;- WT0[i]
  x.df$SEX &lt;- SEX[i]
  
  if(is.null(x.all.df)){
    x.all.df &lt;- x.df
  }else{
    x.all.df &lt;- rbind(x.all.df, x.df)
  }
}</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;mod1&#39; not found</code></pre>
<pre class="r"><code>x.all.df$DV &lt;- x.all.df$Concentration*(exp(rnorm(length(x.all.df$Concentration),0,0.6^2))) + 
  0.01*rnorm(length(x.all.df$Concentration))
x.all.df$DV[x.all.df$DV&lt;0.05]=0.05
x.all.df$DV[x.all.df$Concentration==0]=NA
x.all.df$BLQ=0
x.all.df$BLQ[x.all.df$DV==0.05]=1

my.data &lt;- x.all.df[!is.na(x.all.df$amt),]</code></pre>
<pre><code>## Error in x.all.df[!is.na(x.all.df$amt), ]: incorrect number of dimensions</code></pre>
<pre class="r"><code>my.data$CMT &lt;- 1</code></pre>
<pre><code>## Error in my.data$CMT &lt;- 1: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$CMT_label &lt;- &quot;Dosing&quot;</code></pre>
<pre><code>## Error in my.data$CMT_label &lt;- &quot;Dosing&quot;: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>temp &lt;- x.all.df[is.na(x.all.df$amt),]</code></pre>
<pre><code>## Error in x.all.df[is.na(x.all.df$amt), ]: incorrect number of dimensions</code></pre>
<pre class="r"><code>temp$CMT &lt;- 2
temp$CMT_label &lt;- &quot;PK Concentration&quot;
my.data &lt;- rbind(my.data,temp)</code></pre>
<pre><code>## Error in rbind(my.data, temp): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DV &lt;- signif(my.data$DV,3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$WT0 &lt;- signif(my.data$WT0,3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$time &lt;- round(my.data$time,3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data &lt;- my.data[order(my.data$ID,my.data$time, my.data$CMT),]</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DOSE_label &lt;- paste(my.data$DOSE,&quot;mg&quot;)</code></pre>
<pre><code>## Error in paste(my.data$DOSE, &quot;mg&quot;): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DOSE_label[my.data$DOSE==0] &lt;- &quot;Placebo&quot;</code></pre>
<pre><code>## Error in my.data$DOSE_label[my.data$DOSE == 0] &lt;- &quot;Placebo&quot;: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DOSE_label &lt;- factor(my.data$DOSE_label,levels = c(&quot;Placebo&quot;,paste(unique(my.data$DOSE[my.data$DOSE!=0]),&quot;mg&quot;)))</code></pre>
<pre><code>## Error in factor(my.data$DOSE_label, levels = c(&quot;Placebo&quot;, paste(unique(my.data$DOSE[my.data$DOSE != : object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset &lt;- my.data[,c(&quot;ID&quot;,&quot;time&quot;,&quot;NT&quot;,&quot;amt&quot;,&quot;DV&quot;,&quot;CMT&quot;,&quot;CMT_label&quot;,&quot;BLQ&quot;,&quot;evid&quot;,&quot;WT0&quot;,&quot;SEX&quot;,&quot;DOSE&quot;,&quot;DOSE_label&quot;)]</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>write.csv(Single_Ascending_Dose_Dataset,&quot;../Data/Single_Ascending_Dose_Dataset.csv&quot;,row.names = FALSE)</code></pre>
<pre><code>## Error in is.data.frame(x): object &#39;Single_Ascending_Dose_Dataset&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2 &lt;- Single_Ascending_Dose_Dataset</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Single_Ascending_Dose_Dataset&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$PROFTIME &lt;- Single_Ascending_Dose_Dataset2$NT</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$NOMTIME &lt;- Single_Ascending_Dose_Dataset2$NT</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$YTYPE &lt;- Single_Ascending_Dose_Dataset2$CMT</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$amt[is.na(Single_Ascending_Dose_Dataset2$amt)] &lt;- 0 </code></pre>
<pre><code>## Error in Single_Ascending_Dose_Dataset2$amt[is.na(Single_Ascending_Dose_Dataset2$amt)] &lt;- 0: object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2 &lt;- Single_Ascending_Dose_Dataset2[!(Single_Ascending_Dose_Dataset2$DOSE_label==&quot;Placebo&quot;&amp;
                                      Single_Ascending_Dose_Dataset2$CMT==2),] </code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$BLQ[Single_Ascending_Dose_Dataset2$DOSE_label==&quot;Placebo&quot;&amp;
                                       Single_Ascending_Dose_Dataset2$CMT==2] &lt;- 1L</code></pre>
<pre><code>## Error in Single_Ascending_Dose_Dataset2$BLQ[Single_Ascending_Dose_Dataset2$DOSE_label == : object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$evid &lt;- plyr::mapvalues(Single_Ascending_Dose_Dataset2$evid, c(NA,101), c(0,1))</code></pre>
<pre><code>## Error in plyr::mapvalues(Single_Ascending_Dose_Dataset2$evid, c(NA, 101), : object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$TIMEUNIT &lt;- &quot;Hours&quot;</code></pre>
<pre><code>## Error in Single_Ascending_Dose_Dataset2$TIMEUNIT &lt;- &quot;Hours&quot;: object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$EVENTU[Single_Ascending_Dose_Dataset2$CMT==1] &lt;- &quot;mg&quot;</code></pre>
<pre><code>## Error in Single_Ascending_Dose_Dataset2$EVENTU[Single_Ascending_Dose_Dataset2$CMT == : object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2$EVENTU[Single_Ascending_Dose_Dataset2$CMT==2] &lt;- &quot;ng/mL&quot;</code></pre>
<pre><code>## Error in Single_Ascending_Dose_Dataset2$EVENTU[Single_Ascending_Dose_Dataset2$CMT == : object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Single_Ascending_Dose_Dataset2 &lt;- Single_Ascending_Dose_Dataset2[,c(&quot;ID&quot;,&quot;time&quot;,&quot;NOMTIME&quot;,&quot;TIMEUNIT&quot;,&quot;amt&quot;,&quot;DV&quot;,&quot;CMT&quot;,
                                                                        &quot;CMT_label&quot;,&quot;EVENTU&quot;,&quot;BLQ&quot;,&quot;evid&quot;,&quot;WT0&quot;,&quot;SEX&quot;,&quot;DOSE_label&quot;,
                                                                        &quot;DOSE&quot;)]</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>names(Single_Ascending_Dose_Dataset2) &lt;- c(&quot;ID&quot;,&quot;TIME&quot;,&quot;NOMTIME&quot;,&quot;TIMEUNIT&quot;,&quot;AMT&quot;,&quot;LIDV&quot;,&quot;CMT&quot;,
                                             &quot;NAME&quot;,&quot;EVENTU&quot;,&quot;CENS&quot;,&quot;EVID&quot;,&quot;WEIGHTB&quot;,&quot;SEX&quot;,&quot;TRTACT&quot;,
                                             &quot;DOSE&quot;)</code></pre>
<pre><code>## Error in names(Single_Ascending_Dose_Dataset2) &lt;- c(&quot;ID&quot;, &quot;TIME&quot;, &quot;NOMTIME&quot;, : object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>write.csv(Single_Ascending_Dose_Dataset2,&quot;../Data/Single_Ascending_Dose_Dataset2.csv&quot;,row.names = FALSE)</code></pre>
<pre><code>## Error in is.data.frame(x): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>DT::datatable(Single_Ascending_Dose_Dataset2, rownames = FALSE, options = list(autoWidth = TRUE, scrollX=TRUE)) </code></pre>
<pre><code>## Error in crosstalk::is.SharedData(data): object &#39;Single_Ascending_Dose_Dataset2&#39; not found</code></pre>
</div>
<div id="multiple-ascending-dose-pk-pd-dataset" class="section level3">
<h3>Multiple Ascending Dose PK &amp; PD Dataset</h3>
<pre class="r"><code>set.seed(12345666)
ndose &lt;- 6
nsub &lt;- 10 # number of subproblems

SEX &lt;- rep(c(rep(&quot;Male&quot;,ceiling(nsub/2)),rep(&quot;Female&quot;,floor(nsub/2))),ndose)
WT0 &lt;- (SEX==&quot;Male&quot;)*runif(length(SEX),60,110)+(SEX==&quot;Female&quot;)*runif(length(SEX),50,100)
VCOV &lt;- (WT0/70)*(1-0.5*(SEX==&quot;Female&quot;))
CLCOV &lt;- (WT0/70)*(1-0.5*(SEX==&quot;Female&quot;))

CL &lt;- 0.02*exp(rnorm(nsub*ndose,0,.4^2))*CLCOV
KA &lt;- 0.5*exp(rnorm(nsub*ndose,0,.4^2))
V2 &lt;- 30*exp(rnorm(nsub*ndose,0,.4^2))*VCOV

Kin &lt;- 0.1*exp(rnorm(nsub*ndose,0,0.4^2))
DOSE &lt;- sort(rep(c(0,100,200,400,800,1600),nsub))
theta.all &lt;- 
  cbind(KA=KA, CL=CL, V2=V2,
        Q=10*CLCOV, V3=100*VCOV, V4 = 10000*VCOV, Q2 = 10*CLCOV,
        Kin=Kin, Kout=0.01, EC50 = 1, Emax = 2+2*(SEX==&quot;Female&quot;))

# Nominal times for sampling schedule
SAMPLING &lt;- c(c(-24,-0.1,0.1,0.5,1,2,4,8,12,18,23.9),23.9+seq(1,4)*24,
                                 5*24 + c(0.1,0.5,1,2,4,8,12,18,23.9,36,47.9,71.9,95.9))
DOSING &lt;- seq(0,5*24,24)
NT &lt;- data.frame(NT = c(SAMPLING, DOSING), label = c(rep(&quot;SAMPLING&quot;,length(SAMPLING)),rep(&quot;DOSING&quot;,length(DOSING))))
NT &lt;- NT[order(NT$NT),]

ev.all &lt;- list()
for(idose in 1:length(DOSE)){
  ev.all[[idose]] &lt;- eventTable(amount.units=&#39;mg&#39;, time.units=&#39;hours&#39;)
  # ev.all[[idose]]$add.dosing(dose = DOSE[idose], nbr.doses = 6, dosing.interval = 24)
  # ev.all[[idose]]$add.sampling(c(c(-24,-0.1,0.1,0.5,1,2,4,8,12,18,23.9),23.9+seq(1,4)*24,
  #                                5*24 + c(0.1,0.5,1,2,4,8,12,18,23.9,36,47.9,71.9,95.9)))
  
  # Include some noise in the sampling &amp; dosing schedules
  temp &lt;- NT
  temp$time &lt;- cumsum(c(temp$NT[1] + 0.1*rnorm(1), abs(temp$NT[2:length(temp$NT)]-temp$NT[1:length(temp$NT)-1] + 0.1*rnorm(length(temp$NT)-1))))
  temp$time &lt;- temp$time - temp$time[temp$NT==0] # center at first dose
  
  if(DOSE[idose] &gt; 0){
      ev.all[[idose]]$add.dosing(dose = DOSE[idose], start.time = temp$time[temp$label==&quot;DOSING&quot;])
  }else{
      ev.all[[idose]]$add.dosing(dose = 1e-12, start.time = temp$time[temp$label==&quot;DOSING&quot;])
  }

  ev.all[[idose]]$add.sampling(temp$time[temp$label==&quot;SAMPLING&quot;])
  
}

x.all.df &lt;- NULL
ID = 0
for(i in 1:length(ev.all)){
  ID = ID + 1
  theta &lt;- theta.all[i,]
  inits &lt;- c(depot = 0, centr = 0, peri = 0, peri2 = 0, eff=theta[&quot;Kin&quot;]/theta[&quot;Kout&quot;])
  x &lt;- mod1$solve(theta, ev.all[[i]], inits = inits)
  
  x.df &lt;- data.frame(x)
  x.df$NT &lt;- SAMPLING
    
  temp &lt;- data.frame(ev.all[[i]]$get.dosing())
  temp$NT &lt;- DOSING
  temp[,setdiff(names(x.df),names(temp))]&lt;- NA
  x.df[,setdiff(names(temp),names(x.df))]&lt;- NA
  x.df &lt;- rbind(x.df,temp)
  
  x.df$ID &lt;- ID
  x.df$DOSE &lt;- DOSE[i]
  x.df$WT0 &lt;- WT0[i]
  x.df$SEX &lt;- SEX[i]
  
  if(is.null(x.all.df)){
    x.all.df &lt;- x.df
  }else{
    x.all.df &lt;- rbind(x.all.df, x.df)
  }
}</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;mod1&#39; not found</code></pre>
<pre class="r"><code>x.all.df$DV &lt;- x.all.df$Concentration*(exp(rnorm(length(x.all.df$Concentration),0,0.6^2))) + 
  0.01*rnorm(length(x.all.df$Concentration))
x.all.df$DV[x.all.df$DV&lt;0.05]=0.05
x.all.df$DV[x.all.df$Concentration==0]=NA
x.all.df$BLQ &lt;- 0
x.all.df$BLQ[x.all.df$DV==0.05] &lt;- 1

temp &lt;- exp(rnorm(length(x.all.df$eff),0,0.4^2))
x.all.df$eff2 &lt;- x.all.df$eff*temp + rnorm(length(x.all.df$eff),0,2) + 10*x.all.df$time/(72 + x.all.df$time)

temp &lt;- runif(length(x.all.df$eff),0,1)
x.all.df$Response &lt;- 0
x.all.df$Response[0.2*x.all.df$time/(72 + x.all.df$time) + exp((x.all.df$eff2-30))/(1+exp((x.all.df$eff2-30))) &gt; temp] &lt;- 1 


x.all.df$Severity &lt;- 3
x.all.df$Severity[0.2*x.all.df$time/(72 + x.all.df$time) + exp((x.all.df$eff2-18))/(1+exp((x.all.df$eff2-18))) &gt; temp] &lt;- 2
x.all.df$Severity[0.2*x.all.df$time/(72 + x.all.df$time) + exp((x.all.df$eff2-28))/(1+exp((x.all.df$eff2-28))) &gt; temp] &lt;- 1
x.all.df$Severity_label &lt;- plyr::mapvalues(x.all.df$Severity,c(1,2,3),c(&quot;mild&quot;,&quot;moderate&quot;,&quot;severe&quot;))</code></pre>
<pre><code>## The following `from` values were not present in `x`: 1, 2</code></pre>
<pre class="r"><code>x.all.df$Severity_label &lt;- factor(x.all.df$Severity_label, levels = unique(x.all.df$Severity_label[order(x.all.df$Severity)]))

x.all.df$Count &lt;- NA
x.all.df$Count[!is.na(x.all.df$eff2)]&lt;-rpois(length(na.omit(x.all.df$eff2)), na.omit(10*( 0.5/(1 + x.all.df$time/24) + 0.5*exp(-((x.all.df$eff2)-28))/(1+exp(-((x.all.df$eff2)-28))))) )


my.data &lt;- x.all.df[!is.na(x.all.df$amt),]</code></pre>
<pre><code>## Error in x.all.df[!is.na(x.all.df$amt), ]: incorrect number of dimensions</code></pre>
<pre class="r"><code>my.data$CMT_label &lt;- &quot;Dosing&quot;</code></pre>
<pre><code>## Error in my.data$CMT_label &lt;- &quot;Dosing&quot;: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$CMT &lt;- 1</code></pre>
<pre><code>## Error in my.data$CMT &lt;- 1: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>temp &lt;- x.all.df[is.na(x.all.df$amt),]</code></pre>
<pre><code>## Error in x.all.df[is.na(x.all.df$amt), ]: incorrect number of dimensions</code></pre>
<pre class="r"><code>temp$CMT &lt;- 2
temp$CMT_label &lt;- &quot;PK Concentration&quot;
my.data &lt;- rbind(my.data,temp)</code></pre>
<pre><code>## Error in rbind(my.data, temp): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>temp &lt;- x.all.df[x.all.df$NT%in%c(-0.1,23.9,(23.9+seq(1,9)*24)),]</code></pre>
<pre><code>## Error in x.all.df[x.all.df$NT %in% c(-0.1, 23.9, (23.9 + seq(1, 9) * 24)), : incorrect number of dimensions</code></pre>
<pre class="r"><code>temp$DV &lt;- temp$eff2
temp$CMT &lt;- 3
temp$CMT_label &lt;- &quot;PD - Continuous&quot;
my.data &lt;- rbind(my.data,temp)</code></pre>
<pre><code>## Error in rbind(my.data, temp): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>temp &lt;- x.all.df[x.all.df$NT%in%c(-0.1,23.9,23.9+seq(1,9)*24),]</code></pre>
<pre><code>## Error in x.all.df[x.all.df$NT %in% c(-0.1, 23.9, 23.9 + seq(1, 9) * 24), : incorrect number of dimensions</code></pre>
<pre class="r"><code>temp$DV &lt;- temp$Count
temp$CMT &lt;- 4
temp$CMT_label &lt;- &quot;PD - Count&quot;
my.data &lt;- rbind(my.data,temp)</code></pre>
<pre><code>## Error in rbind(my.data, temp): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>temp &lt;- x.all.df[x.all.df$NT%in%c(-24,23.9,23.9+seq(1,9)*24),]</code></pre>
<pre><code>## Error in x.all.df[x.all.df$NT %in% c(-24, 23.9, 23.9 + seq(1, 9) * 24), : incorrect number of dimensions</code></pre>
<pre class="r"><code>temp$DV &lt;- temp$Severity
temp$CMT &lt;- 5
temp$CMT_label &lt;- &quot;PD - Ordinal&quot;
my.data &lt;- rbind(my.data,temp)</code></pre>
<pre><code>## Error in rbind(my.data, temp): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>temp &lt;- x.all.df[x.all.df$NT%in%c(-0.1,23.9,(23.9+seq(1,9)*24)),]</code></pre>
<pre><code>## Error in x.all.df[x.all.df$NT %in% c(-0.1, 23.9, (23.9 + seq(1, 9) * 24)), : incorrect number of dimensions</code></pre>
<pre class="r"><code>temp$DV &lt;- temp$Response
temp$CMT &lt;- 6
temp$CMT_label &lt;- &quot;PD - Binary&quot;
my.data &lt;- rbind(my.data,temp)</code></pre>
<pre><code>## Error in rbind(my.data, temp): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DV &lt;- signif(my.data$DV,3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$WT0 &lt;- signif(my.data$WT0,3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$time &lt;- round(my.data$time,3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data &lt;- my.data[order(my.data$ID,my.data$time, my.data$CMT),]</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DOSE_label &lt;- paste(my.data$DOSE,&quot;mg&quot;)</code></pre>
<pre><code>## Error in paste(my.data$DOSE, &quot;mg&quot;): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DOSE_label[my.data$DOSE==0] &lt;- &quot;Placebo&quot;</code></pre>
<pre><code>## Error in my.data$DOSE_label[my.data$DOSE == 0] &lt;- &quot;Placebo&quot;: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DOSE_label &lt;- factor(my.data$DOSE_label,levels = c(&quot;Placebo&quot;,paste(unique(my.data$DOSE[my.data$DOSE!=0]),&quot;mg&quot;)))</code></pre>
<pre><code>## Error in factor(my.data$DOSE_label, levels = c(&quot;Placebo&quot;, paste(unique(my.data$DOSE[my.data$DOSE != : object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DAY &lt;- floor(my.data$NT/24)+1</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DAY_label &lt;- paste(&quot;Day&quot;,ceiling(my.data$DAY))</code></pre>
<pre><code>## Error in paste(&quot;Day&quot;, ceiling(my.data$DAY)): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DAY_label[my.data$DAY&lt;=0]&lt;-&quot;Baseline&quot;</code></pre>
<pre><code>## Error in my.data$DAY_label[my.data$DAY &lt;= 0] &lt;- &quot;Baseline&quot;: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$DAY_label &lt;- factor(my.data$DAY_label,
                            levels = c(&quot;Baseline&quot;,paste(&quot;Day&quot;,sort(unique(ceiling(my.data$DAY))))))</code></pre>
<pre><code>## Error in factor(my.data$DAY_label, levels = c(&quot;Baseline&quot;, paste(&quot;Day&quot;, : object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$CYCLE &lt;- my.data$DAY</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>my.data$CYCLE[my.data$CYCLE&gt;6] &lt;- 6</code></pre>
<pre><code>## Error in my.data$CYCLE[my.data$CYCLE &gt; 6] &lt;- 6: object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code># temp &lt;- my.data[my.data$DAY_label==&quot;Baseline&quot;&amp;my.data$CMT!=2,]
# temp$Severity0 &lt;- temp$Severity
# temp$Response0 &lt;- temp$Response
# temp$Count0 &lt;- temp$Count
# temp$eff20 &lt;- temp$eff2
# 
# cnames &lt;- c(&quot;ID&quot;,&quot;Severity0&quot;,&quot;Response0&quot;,&quot;Count0&quot;,&quot;eff20&quot;)
# 
# my.data2 &lt;- merge(my.data, unique(temp[,cnames]),by=c(&quot;ID&quot;),all.x=TRUE)


Multiple_Ascending_Dose_Dataset &lt;- my.data[,c(&quot;ID&quot;,&quot;time&quot;,&quot;NT&quot;,&quot;amt&quot;,&quot;DV&quot;,&quot;CMT&quot;,&quot;CMT_label&quot;,&quot;BLQ&quot;,&quot;evid&quot;,&quot;WT0&quot;,&quot;SEX&quot;,&quot;DOSE_label&quot;,&quot;DOSE&quot;,&quot;DAY&quot;,&quot;DAY_label&quot;,&quot;Response&quot;,&quot;Severity&quot;,&quot;Severity_label&quot;,&quot;Count&quot;,&quot;CYCLE&quot;)]</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;my.data&#39; not found</code></pre>
<pre class="r"><code>write.csv(Multiple_Ascending_Dose_Dataset,&quot;../Data/Multiple_Ascending_Dose_Dataset.csv&quot;,row.names = FALSE)</code></pre>
<pre><code>## Error in is.data.frame(x): object &#39;Multiple_Ascending_Dose_Dataset&#39; not found</code></pre>
<pre class="r"><code># DT::datatable(Multiple_Ascending_Dose_Dataset[,c(&quot;time&quot;,&quot;NT&quot;,&quot;ID&quot;,&quot;CMT&quot;,&quot;DV&quot;,&quot;DOSE&quot;,&quot;DOSE_label&quot;,&quot;WT0&quot;,&quot;SEX&quot;,&quot;DAY&quot;,&quot;DAY_label&quot;,&quot;CMT_label&quot;)], rownames = FALSE, options = list(autoWidth = TRUE, scrollX=TRUE))

Multiple_Ascending_Dose_Dataset2 &lt;- Multiple_Ascending_Dose_Dataset</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Multiple_Ascending_Dose_Dataset&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$PROFTIME &lt;- Multiple_Ascending_Dose_Dataset2$NT - (Multiple_Ascending_Dose_Dataset2$CYCLE-1)*24</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$NOMTIME &lt;- Multiple_Ascending_Dose_Dataset2$NT</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$YTYPE &lt;- Multiple_Ascending_Dose_Dataset2$CMT</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$amt[is.na(Multiple_Ascending_Dose_Dataset2$amt)] &lt;- 0 </code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$amt[is.na(Multiple_Ascending_Dose_Dataset2$amt)] &lt;- 0: object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2 &lt;- Multiple_Ascending_Dose_Dataset2[!(Multiple_Ascending_Dose_Dataset2$DOSE_label==&quot;Placebo&quot;&amp;
                                      Multiple_Ascending_Dose_Dataset2$CMT==2),] </code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$BLQ[Multiple_Ascending_Dose_Dataset2$DOSE_label==&quot;Placebo&quot;&amp;
                                       Multiple_Ascending_Dose_Dataset2$CMT==2] &lt;- 1L</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$BLQ[Multiple_Ascending_Dose_Dataset2$DOSE_label == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$evid &lt;- plyr::mapvalues(Multiple_Ascending_Dose_Dataset2$evid, c(NA,101), c(0,1))</code></pre>
<pre><code>## Error in plyr::mapvalues(Multiple_Ascending_Dose_Dataset2$evid, c(NA, : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$TIMEUNIT &lt;- &quot;Hours&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$TIMEUNIT &lt;- &quot;Hours&quot;: object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT==1] &lt;- &quot;mg&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT==2] &lt;- &quot;ng/mL&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT==3] &lt;- &quot;IU/L&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT==4] &lt;- &quot;count&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT==5] &lt;- &quot;severity&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT==6] &lt;- &quot;response&quot;</code></pre>
<pre><code>## Error in Multiple_Ascending_Dose_Dataset2$EVENTU[Multiple_Ascending_Dose_Dataset2$CMT == : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>Multiple_Ascending_Dose_Dataset2 &lt;- Multiple_Ascending_Dose_Dataset2[,c(&quot;ID&quot;,&quot;time&quot;,&quot;NOMTIME&quot;,&quot;TIMEUNIT&quot;,&quot;amt&quot;,&quot;DV&quot;,&quot;CMT&quot;,
                                                                        &quot;CMT_label&quot;,&quot;EVENTU&quot;,&quot;BLQ&quot;,&quot;evid&quot;,&quot;WT0&quot;,&quot;SEX&quot;,&quot;DOSE_label&quot;,
                                                                        &quot;DOSE&quot;,&quot;DAY&quot;,&quot;PROFTIME&quot;,&quot;CYCLE&quot;)]</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>names(Multiple_Ascending_Dose_Dataset2) &lt;- c(&quot;ID&quot;,&quot;TIME&quot;,&quot;NOMTIME&quot;,&quot;TIMEUNIT&quot;,&quot;AMT&quot;,&quot;LIDV&quot;,&quot;CMT&quot;,
                                             &quot;NAME&quot;,&quot;EVENTU&quot;,&quot;CENS&quot;,&quot;EVID&quot;,&quot;WEIGHTB&quot;,&quot;SEX&quot;,&quot;TRTACT&quot;,
                                             &quot;DOSE&quot;,&quot;PROFDAY&quot;,&quot;PROFTIME&quot;,&quot;CYCLE&quot;)</code></pre>
<pre><code>## Error in names(Multiple_Ascending_Dose_Dataset2) &lt;- c(&quot;ID&quot;, &quot;TIME&quot;, &quot;NOMTIME&quot;, : object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>write.csv(Multiple_Ascending_Dose_Dataset2,&quot;../Data/Multiple_Ascending_Dose_Dataset2.csv&quot;,row.names = FALSE)</code></pre>
<pre><code>## Error in is.data.frame(x): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
<pre class="r"><code>DT::datatable(Multiple_Ascending_Dose_Dataset2, rownames = FALSE, options = list(autoWidth = TRUE, scrollX=TRUE) )</code></pre>
<pre><code>## Error in crosstalk::is.SharedData(data): object &#39;Multiple_Ascending_Dose_Dataset2&#39; not found</code></pre>
</div>
</div>
<div id="r-session-info" class="section level2">
<h2>R Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Red Hat Enterprise Linux Server 7.9 (Maipo)
## 
## Matrix products: default
## BLAS/LAPACK: /CHBS/apps/EB/software/imkl/2019.1.144-gompi-2019a/compilers_and_libraries_2019.1.144/linux/mkl/lib/intel64_lin/libmkl_gf_lp64.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8   
##  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] nlme_3.1-160      emmeans_1.6.3     brms_2.18.0       Rcpp_1.0.9        DoseFinding_1.0-1 mvtnorm_1.1-3     lattice_0.20-45   RxODE_1.1.1      
##  [9] survminer_0.4.9   ggpubr_0.4.0      survival_3.4-0    knitr_1.40        broom_1.0.1       caTools_1.18.2    DT_0.26           forcats_0.5.2    
## [17] stringr_1.4.1     purrr_0.3.5       readr_2.1.3       tibble_3.1.8      tidyverse_1.3.2   xgxr_1.1.1        zoo_1.8-11        gridExtra_2.3    
## [25] tidyr_1.2.1       dplyr_1.0.10      ggplot2_3.3.6    
## 
## loaded via a namespace (and not attached):
##   [1] utf8_1.2.2           lme4_1.1-30          tidyselect_1.2.0     htmlwidgets_1.5.4    grid_4.1.0           munsell_0.5.0        codetools_0.2-18    
##   [8] interp_1.1-2         miniUI_0.1.1.1       withr_2.5.0          Brobdingnag_1.2-9    colorspace_2.0-3     highr_0.9            rstudioapi_0.14     
##  [15] stats4_4.1.0         DescTools_0.99.42    ggsignif_0.6.2       bayesplot_1.9.0      labeling_0.4.2       rstan_2.21.7         KMsurv_0.1-5        
##  [22] farver_2.1.1         bridgesampling_1.1-2 TH.data_1.1-1        coda_0.19-4          vctrs_0.5.0          generics_0.1.3       xfun_0.34           
##  [29] R6_2.5.1             markdown_1.2         gamm4_0.2-6          projpred_2.0.2       rex_1.2.1            bitops_1.0-7         cachem_1.0.6        
##  [36] reshape_0.8.8        PreciseSums_0.5      assertthat_0.2.1     promises_1.2.0.1     lotri_0.4.2          scales_1.2.1         multcomp_1.4-20     
##  [43] nnet_7.3-17          googlesheets4_1.0.1  rootSolve_1.8.2.2    gtable_0.3.1         processx_3.7.0       lmom_2.8             sandwich_3.0-2      
##  [50] rlang_1.0.6          splines_4.1.0        rstatix_0.7.0        lazyeval_0.2.2       gargle_1.2.1         inline_0.3.19        checkmate_2.1.0     
##  [57] reshape2_1.4.4       yaml_2.3.6           abind_1.4-5          modelr_0.1.9         threejs_0.3.3        crosstalk_1.2.0      backports_1.4.1     
##  [64] rsconnect_0.8.28     httpuv_1.6.6         Hmisc_4.7-0          tensorA_0.36.2       tools_4.1.0          ellipsis_0.3.2       jquerylib_0.1.4     
##  [71] posterior_1.3.1      RColorBrewer_1.1-3   proxy_0.4-26         ggridges_0.5.4       plyr_1.8.7           base64enc_0.1-3      progress_1.2.2      
##  [78] RCurl_1.98-1.4       ps_1.7.1             prettyunits_1.1.1    rpart_4.1.16         deldir_1.0-6         haven_2.5.1          cluster_2.1.3       
##  [85] fs_1.5.2             magrittr_2.0.3       data.table_1.14.2    openxlsx_4.2.4       colourpicker_1.1.1   reprex_2.0.2         googledrive_2.0.0   
##  [92] matrixStats_0.62.0   stringfish_0.15.7    shinyjs_2.1.0        hms_1.1.2            qs_0.25.3            mime_0.12            evaluate_0.17       
##  [99] xtable_1.8-4         shinystan_2.6.0      rio_0.5.27           jpeg_0.1-9           readxl_1.4.1         rstantools_2.2.0     compiler_4.1.0      
## [106] crayon_1.5.2         minqa_1.2.4          StanHeaders_2.21.0-7 htmltools_0.5.3      mgcv_1.8-41          later_1.3.0          tzdb_0.3.0          
## [113] Formula_1.2-4        expm_0.999-6         Exact_2.1            RcppParallel_5.1.5   lubridate_1.8.0      DBI_1.1.3            RApiSerialize_0.1.0 
## [120] dbplyr_2.2.1         MASS_7.3-58.1        boot_1.3-28          sys_3.4              Matrix_1.5-1         car_3.0-11           cli_3.4.1           
## [127] igraph_1.3.5         parallel_4.1.0       pkgconfig_2.0.3      km.ci_0.5-2          foreign_0.8-82       binom_1.1-1          xml2_1.3.3          
## [134] dygraphs_1.1.1.6     bslib_0.4.0          estimability_1.3     minpack.lm_1.2-1     rvest_1.0.3          callr_3.7.2          distributional_0.3.1
## [141] digest_0.6.30        rmarkdown_2.17       cellranger_1.1.0     survMisc_0.5.5       htmlTable_2.2.1      Deriv_4.1.3          gld_2.6.2           
## [148] dparser_1.3.1-5      curl_4.3.3           gtools_3.9.3         shiny_1.7.2          nloptr_2.0.3         lifecycle_1.0.3      jsonlite_1.8.3      
## [155] carData_3.0-4        fansi_1.0.3          pillar_1.8.1         loo_2.5.1            GGally_2.1.2         pkgbuild_1.3.1       fastmap_1.1.0       
## [162] httr_1.4.4           xts_0.12.2           glue_1.6.2           zip_2.2.0            shinythemes_1.2.0    png_0.1-7            pander_0.6.4        
## [169] class_7.3-19         stringi_1.7.8        sass_0.4.2           latticeExtra_0.6-30  memoise_2.0.1        e1071_1.7-8</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
